---
title: Risoluzione dei problemi di Proxy applicazione Web
ms.author: kgremban
author: eross-msft
ms.date: 07/13/2016
ms.topic: article
ms.prod: windows-server
ms.assetid: a2fef55d-747b-4e20-8f21-5f8807e7ef87
ms.technology: web-app-proxy
ms.openlocfilehash: e0907f2b096301418b5a65b87a06f97af683d4e4
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/08/2020
ms.locfileid: "80818644"
---
# <a name="troubleshooting-web-application-proxy"></a>Risoluzione dei problemi di Proxy applicazione Web

>Si applica a: Windows Server 2016

**Questo contenuto è pertinente per la versione locale del proxy applicazione Web. Per abilitare l'accesso sicuro alle applicazioni locali tramite il cloud, vedere il [Azure ad contenuto del proxy di applicazione](https://azure.microsoft.com/documentation/articles/active-directory-application-proxy-get-started/).**  
  
Questa sezione vengono fornite le procedure di risoluzione dei problemi per il Proxy di applicazione Web incluse soluzioni e le spiegazioni di eventi. Ci sono tre posizioni in cui vengono visualizzati errori:  
  
-   Nella console di amministrazione di Proxy applicazione Web  
  
    Ogni ID evento elencato nella console di amministrazione possono essere visualizzati nel Visualizzatore eventi di Windows e descrizioni corrispondenti e le soluzioni si trovano di sotto.  
  
    Aprire il Visualizzatore eventi e cercare gli eventi relativi al Proxy di applicazione Web in **registri applicazioni e servizi** > **Microsoft** > **Windows** > **Proxy applicazione Web** > **amministrazione**  
  
    ![](media/Troubleshooting-Web-Application-Proxy/WebApplicationProxyTroubleshooting.png)  
  
    Se necessario, i registri dettagliati sono disponibili attivando l'analisi e i registri di debug e l'attivazione del log di sessione Proxy applicazione Web, nel Visualizzatore eventi di Windows in \ Microsoft \ Windows \ Proxy applicazione Web \ amministratore.  
  
-   Errori di PowerShell  
  
    Eventi dei problemi riscontrati durante la configurazione vengono visualizzati in PowerShell.  
  
    Tutti gli errori vengono presentati all'utente di PowerShell utilizzando richieste di errore standard PowerShell. Tutti i comandi di PowerShell vengono registrati come eventi. Tutti gli eventi che si verificano in PowerShell sono elencati nel Visualizzatore eventi di Windows con il numero di ID 12016 e sono definiti di seguito nella sezione relativa a PowerShell.  
  
-   In Best Practices Analyzer  
  
    Questi eventi sono descritti nel [Best Practices Analyzer per il Proxy di applicazione Web](assetId:///995f5cea-e334-4ce6-a14c-6a2d03c0c79a)  
  
## <a name="powershell-messages"></a>Messaggi di PowerShell  
  
|Evento o sintomo|Possibile causa|Risoluzione|  
|--------------------|------------------|--------------|  
|Il certificato attendibile ("ADFS ProxyTrust - <WAP machine name>") non è valido|La causa potrebbe essere una delle seguenti:<p>-Il computer Proxy applicazione era inattivo per troppo tempo.<br />-Disconnessioni tra il Proxy applicazione Web e AD FS<br />-Problemi dell'infrastruttura certificate<br />-Le modifiche nel computer ADFS o il processo di rinnovo tra il Proxy dell'applicazione Web e AD FS non è stato eseguito come pianificato ogni 8 ore, quindi è necessario rinnovare l'attendibilità<br />-L'orologio del computer Proxy applicazione Web e AD FS non sono sincronizzati.|Assicurarsi che gli orologi vengono sincronizzati. Eseguire il cmdlet Install-WebApplicationProxy.|  
|Dati di configurazione non trovati in ADFS|È possibile che il Proxy di applicazione Web non è stato installato completamente ancora o a causa della modifica il database di ADFS o il danneggiamento del database.|Eseguire il Cmdlet Install-WebApplicationProxy|  
|Si è verificato un errore durante il tentativo di leggere la configurazione di ADFS di Proxy applicazione Web.|Questo potrebbe indicare che ADFS non è raggiungibile o che ADFS ha rilevato un errore interno durante la lettura di configurazione dal database di ADFS.|Verificare che ADFS sia raggiungibile e che funzioni correttamente.|  
|I dati di configurazione archiviati in ADFS sono danneggiati o Proxy applicazione Web è stato in grado di analizzare.<p>OPPURE<p>Proxywas di applicazione Web non è possibile recuperare l'elenco di Relying party da ADFS.|Ciò può verificarsi se i dati di configurazione sono stati modificati in ADFS.|Riavviare il Proxyservice di applicazione Web. Se il problema persiste, eseguire il Cmdlet Install-WebApplicationProxy.|  
  
## <a name="administrator-console-events"></a>Eventi della Console di amministrazione  
I seguenti eventi console di amministrazione sono in genere indicativi di errori di autenticazione, tokes non valido o scaduto cookie.  
  
|Evento o sintomo|Possibile causa|Risoluzione|  
|--------------------|------------------|--------------|  
|11005<p>Proxy applicazione Web Impossibile creare la chiave di crittografia cookie utilizzando la chiave privata dalla configurazione.|Il parametro di configurazione globale "AccessCookiesEncryptionKey" è stato modificato tramite il comando di PowerShell: Set-WebApplicationProxyConfiguration - RegenerateAccessCookiesEncryptionKey|Non è necessaria alcuna azione. Il cookie problematico è stato rimosso e l'utente è stato reindirizzato al servizio token di sicurezza per l'autenticazione.|  
|12000<p>Proxy applicazione Web Impossibile verificare le modifiche di configurazione per almeno 60 minuti|Proxy applicazione Web non può accedere alla configurazione di Proxy applicazione Web utilizzando il comando Get-WebApplicationProxyConfiguration o dell'applicazione. Questo è in genere causato da mancanza di connettività con ADFS o dover rinnovare relazione di trust con ADFS.|Verificare la connettività con AD FS. È possibile farlo utilizzando il collegamento di https://<FQDN_AD_FS_Proxy>/FederationMetadata/2007-06/FederationMetadata.xmlMake che vi sia attendibilità stabilita tra ADFS e Proxy applicazione Web. Se queste soluzioni non funzionano, eseguire il Cmdlet Install-WebApplicationProxy.|  
|12003<p>Proxy applicazione Web non è riuscito ad analizzare il cookie di accesso.|Questo può indicare che il Proxy dell'applicazione Web e AD FS non sono connessi o che non ricevono la stessa configurazione.|Verificare la connettività con AD FS. È possibile farlo utilizzando il collegamento di https://<FQDN_AD_FS_Proxy>/FederationMetadata/2007-06/FederationMetadata.xmlMake che vi sia attendibilità stabilita tra ADFS e Proxy applicazione Web. Se queste soluzioni non funzionano, eseguire il Cmdlet Install-WebApplicationProxy.|  
|12004<p>Proxy applicazione Web ha ricevuto una richiesta con un cookie di accesso non validi.|Questo evento può indicare che il Proxy dell'applicazione Web e AD FS non sono connessi o che non ricevono la stessa configurazione.<p>Se è stato eseguito il parametro "AccessCookiesEncryptionKey" è stato chaged dal comando di PowerShell Set-WebApplicationProxyConfiguration - RegenerateAccessCookiesEncryptionKey, questo evento è normale e non eseguire passaggi di risoluzione.|Verificare la connettività con AD FS. È possibile farlo utilizzando il collegamento di https://<FQDN_AD_FS_Proxy>/FederationMetadata/2007-06/FederationMetadata.xmlMake che vi sia attendibilità stabilita tra ADFS e Proxy applicazione Web. Se queste soluzioni non funzionano, eseguire il Cmdlet Install-WebApplicationProxy.|  
|12008<p>Proxy applicazione Web ha superato il numero massimo di tentativi di autenticazione Kerberos consentiti al server back-end.|Questo evento può indicare una configurazione errata tra Proxy applicazione Web e il server applicazioni back-end o un problema di configurazione di data e ora su entrambi i computer.|Il server back-end ha rifiutato il ticket Kerberos creato da Proxy applicazione Web. Verificare che la configurazione del Proxy applicazione Web e il server applicazioni back-end siano configurati correttamente.<p>Assicurarsi che la configurazione di data e ora in Proxy applicazione Web e il server applicazioni back-end siano sincronizzate.|  
|12011<p>Proxy applicazione Web ha ricevuto una richiesta con una firma di cookie di accesso non valido.|Questo evento può indicare che il Proxy dell'applicazione Web e AD FS non sono connessi o che non ricevono la stessa configurazione. Se è stato eseguito il parametro "AccessCookiesEncryptionKey" è stato chaged dal comando di PowerShell Set-WebApplicationProxyConfiguration - RegenerateAccessCookiesEncryptionKey, questo evento è normale e non eseguire passaggi di risoluzione.|Verificare la connettività con AD FS. È possibile farlo utilizzando il collegamento di https://<FQDN_AD_FS_Proxy>/FederationMetadata/2007-06/FederationMetadata.xmlMake che vi sia attendibilità stabilita tra ADFS e Proxy applicazione Web. Se queste soluzioni non funzionano, eseguire il Cmdlet Install-WebApplicationProxy.|  
|12027<p>Il proxy ha rilevato un errore imprevisto durante l'elaborazione della richiesta. Il nome specificato non è un nome di account formulato correttamente.|Questo evento può indicare una configurazione errata tra Proxy applicazione Web e il server di controller di dominio o un problema di configurazione di data e ora su entrambi i computer.|Il controller di dominio ha rifiutato il ticket Kerberos creato da Proxy applicazione Web. Verificare che la configurazione del Proxy applicazione Web e il server applicazioni back-end siano configurate correttamente, in particolare la configurazione del nome SPN. Assicurarsi che il Proxy dell'applicazione Web fa parte dello stesso dominio del controller di dominio per assicurarsi che il controller di dominio stabilisce relazioni di trust con Proxy.Make di applicazione Web verificare che siano sincronizzati la configurazione di data e ora in Proxy applicazione Web e il controller di dominio del dominio.|  
|13012<p>Proxy applicazione Web ha ricevuto una firma di token non validi edge||Assicurarsi che è stato aggiornato il Proxy di applicazione Web con [KB 2955164](https://go.microsoft.com/fwlink/?LinkId=400701).|  
|13013<p>Proxy applicazione Web ha ricevuto una richiesta contenente un token scaduto edge.|ADFS e Proxy applicazione Web non dispone di una sincronizzazione degli orologi.|Sincronizzare gli orologi tra ADFS e Proxy applicazione Web.|  
|13014<p>Proxy applicazione Web ha ricevuto una richiesta con un token perimetrale non validi. Il token non è valido perché non può essere analizzata.|Questo può indicare un problema con la configurazione di ADFS.|Controllare la configurazione di ADFS e, se necessario, ripristinare la configurazione predefinita.|  
|13015<p>Proxy applicazione Web ha ricevuto una richiesta con un cookie di accesso scaduto.|Ciò può indicare gli orologi non sono sincronizzati.|Se si lavora con un cluster di computer Proxy applicazione Web, assicurarsi che la data e ora delle macchine siano sincronizzati.|  
|13016<p>Proxy applicazione Web non può recuperare un ticket Kerberos per conto dell'utente perché non esiste alcun UPN nel token perimetrale o nel cookie di accesso.|Si è verificato un problema con la configurazione del servizio token di sicurezza.|Correggere la configurazione di attestazione UPN nel servizio token di sicurezza.|  
|13019<p>Proxy applicazione Web non può recuperare un ticket Kerberos per conto dell'utente a causa del seguente errore generale di API|Questo evento può indicare una configurazione errata tra Proxy applicazione Web e il server di controller di dominio o un problema di configurazione di data e ora su entrambi i computer.|Il controller di dominio ha rifiutato il ticket Kerberos creato da Proxy applicazione Web. Verificare che la configurazione del Proxy applicazione Web e il server applicazioni back-end siano configurate correttamente, in particolare la configurazione del nome SPN. Assicurarsi che il Proxy dell'applicazione Web fa parte dello stesso dominio del controller di dominio per assicurarsi che il controller di dominio stabilisce relazioni di trust con Proxy.Make di applicazione Web verificare che siano sincronizzati la configurazione di data e ora in Proxy applicazione Web e il controller di dominio del dominio.|  
|13020<p>Proxy applicazione Web non può recuperare un ticket Kerberos per conto dell'utente perché il server back-end SPN non è definito.|Questo evento può indicare una configurazione errata tra Proxy applicazione Web e il server di controller di dominio o un problema di configurazione di data e ora su entrambi i computer.|Il controller di dominio ha rifiutato il ticket Kerberos creato da Proxy applicazione Web. Verificare che la configurazione del Proxy applicazione Web e il server applicazioni back-end siano configurate correttamente, in particolare la configurazione del nome SPN. Assicurarsi che il Proxy dell'applicazione Web fa parte dello stesso dominio del controller di dominio per assicurarsi che il controller di dominio stabilisce relazioni di trust con Proxy.Make di applicazione Web verificare che siano sincronizzati la configurazione di data e ora in Proxy applicazione Web e il controller di dominio del dominio.|  
|13022<p>Proxy applicazione Web non può autenticare l'utente perché il server back-end risponde ai tentativi di autenticazione Kerberos con un errore HTTP 401.|Questo evento può indicare una configurazione errata tra Proxy applicazione Web e il server applicazioni back-end o un problema di configurazione di data e ora su entrambi i computer.|Il server back-end ha rifiutato il ticket Kerberos creato da Proxy applicazione Web. Verificare che la configurazione del Proxy applicazione Web e il server applicazioni back-end siano configurati correttamente. Assicurarsi che la configurazione di data e ora in Proxy applicazione Web e il server applicazioni back-end siano sincronizzate.|  
|13025<p>Il client non ha presentato un certificato SSL al Proxy di applicazione Web.|Questo evento può indicare un problema di configurazione di data e ora.|Assicurarsi che l'infrastruttura di certificazione sia valido e che la data di ADFS e Proxy applicazione Web e l'ora siano sincronizzati. Assicurarsi che l'identificazione personale configurata per il Proxy dell'applicazione Web sia quello corretto.|  
|13026<p>Il client ha inviato un certificato SSL al Proxy di applicazione Web, ma il certificato non è valido: il certificato non corrisponde l'identificazione personale.|Questo evento può indicare un problema di configurazione di data e ora.|Assicurarsi che l'infrastruttura di certificazione sia valido e che la data di ADFS e Proxy applicazione Web e l'ora siano sincronizzati. Assicurarsi che l'identificazione personale configurata per il Proxy dell'applicazione Web sia quello corretto.|  
|13028<p>Proxy applicazione Web ha ricevuto una richiesta contenente un token di edge che non è ancora valido.|Questo evento può indicare un problema di configurazione di data e ora.|Assicurarsi che l'infrastruttura di certificazione sia valido e che la data di ADFS e Proxy applicazione Web e l'ora siano sincronizzati.|  
|13030<p>Il client ha inviato un certificato SSL al Proxy di applicazione Web, ma il provider di attendibilità non considera attendibile l'autorità di certificazione che ha emesso il certificato client.|Questo evento può indicare un problema di configurazione di data e ora.|Assicurarsi che l'infrastruttura di certificazione sia valido e che la data di ADFS e Proxy applicazione Web e l'ora siano sincronizzati. Assicurarsi che l'identificazione personale configurata per il Proxy dell'applicazione Web sia quello corretto.|  
|13031<p>Il client ha inviato un certificato SSL al Proxy di applicazione Web è stata interrotta la catena di certificati in un certificato radice non è considerato attendibile dal provider di attendibilità.|Questo evento può indicare un problema di configurazione di data e ora.|Assicurarsi che l'infrastruttura di certificazione sia valido e che la data di ADFS e Proxy applicazione Web e l'ora siano sincronizzati. Assicurarsi che l'identificazione personale configurata per il Proxy dell'applicazione Web sia quello corretto.|  
|13032<p>Il client ha inviato un certificato SSL al Proxy di applicazione Web, ma il certificato non è valido per l'utilizzo richiesto.|Questo evento può indicare un problema di configurazione di data e ora.|Assicurarsi che l'infrastruttura di certificazione sia valido e che la data di ADFS e Proxy applicazione Web e l'ora siano sincronizzati. Assicurarsi che l'identificazione personale configurata per il Proxy dell'applicazione Web sia quello corretto.|  
|13033<p>Il client ha inviato un certificato SSL al Proxy di applicazione Web, ma il certificato non è in corso di validità se verificato rispetto all'ora corrente del sistema o al timestamp sul file firmato.|Questo evento può indicare un problema di configurazione di data e ora.|Assicurarsi che l'infrastruttura di certificazione sia valido e che la data di ADFS e Proxy applicazione Web e l'ora siano sincronizzati. Assicurarsi che l'identificazione personale configurata per il Proxy dell'applicazione Web sia quello corretto.|  
|13034<p>Il client ha inviato un certificato SSL al Proxy di applicazione Web, ma il certificato non valido.|Questo evento può indicare un problema di configurazione di data e ora.|Assicurarsi che l'infrastruttura di certificazione sia valido e che la data di ADFS e Proxy applicazione Web e l'ora siano sincronizzati. Assicurarsi che l'identificazione personale configurata per il Proxy dell'applicazione Web sia quello corretto.|  
  
I seguenti eventi di console di amministrazione sono in genere indicativi di problemi di configurazione, ad esempio il provisioning, richiesta che non hanno esito positivo, il server back-end che non è raggiungibile e overflow del buffer.  
  
|Evento o sintomo|Possibile causa|Risoluzione|  
|--------------------|------------------|--------------|  
|12019<p>Proxy applicazione Web Impossibile creare un listener per l'URL seguente.|Delle possibile cause per l'evento è che un altro servizio sia in ascolto allo stesso URL.|L'amministratore deve assicurarsi che non è in ascolto o associa gli stessi URL. A tale scopo, eseguire il comando: netsh http show urlacl. Se questo URL viene utilizzato da un altro componente in esecuzione sul computer Proxy applicazione Web, rimuoverla o utilizzare un URL diverso per pubblicare applicazioni mediante Proxy applicazione Web.|  
|12020<p>Proxy applicazione Web Impossibile creare una prenotazione per l'URL seguente.|Una possibile causa l'evento è che un altro servizio disponga di una prenotazione per lo stesso URL.|L'amministratore deve assicurarsi che nessun altro associa gli stessi URL. A tale scopo, eseguire il comando: netsh http show urlacl. Se questo URL viene utilizzato da un altro componente in esecuzione sul computer Proxy applicazione Web, rimuoverla o utilizzare un URL diverso per pubblicare applicazioni mediante Proxy applicazione Web.|  
|12021<p>Proxy applicazione Web non è riuscito a collegare il certificato server SSL. Sono state applicate tutte le altre impostazioni di configurazione.|Impossibile creare e impostare un record di configurazione dei dati del certificato SSL.|Assicurarsi che le identificazioni personali certificato configurati per Proxyapplications di applicazione Web sono installate in tutti i computer Proxy applicazione Web con una chiave privata nell'archivio del computer locale.|  
|13001<p>Il certificato server SSL presentato al Proxy di applicazione Web dal server back-end non è valido. il certificato non è attendibile.|Il certificato Secure Sockets Layer (SSL) inviato dal server sono stati rilevati uno o più errori. Ciò può indicare che il server back-end fornito un certificato SSL non valido o che non vi sia alcuna relazione di trust tra il Proxy dell'applicazione Web e il server back-end.|Convalidare un certificato SSL del server back-end. Verificare che il computer del proxy dell'applicazione Web sia configurato con le autorità di certificazione radice corrette per considerare attendibile il certificato del server back-end.|  
|13006|Quando il codice di errore 0x80072ee7, il failurrre è causato dall'impossibilità di risolvere l'URL del server back-end. Altri codici di errore sono descritti in [https://msdn.microsoft.com/library/windows/desktop/aa384110(v=vs.85)](https://msdn.microsoft.com/library/windows/desktop/aa384110(v=vs.85))|Verificare che l'URL del server back-end sia corretto e che il nome può essere risolto correttamente dal computer Proxy applicazione Web.|  
|13007<p>La risposta HTTP dal server back-end non è stata ricevuta entro l'intervallo previsto.|La richiesta del server back-end è scaduta o è lento o non risponde.|Controllare la configurazione del server back-end. Se è molto lenta, controllare la connettività al server back-end e inoltre provare a modificare il cmdlet di parametro di configurazione globale di Proxy applicazione Web per InactiveTransactionsTimeoutSec.|  
  
## <a name="see-also"></a>Vedi anche  
[Novità di proxy applicazione Web in Windows Server 2016](web-application-proxy-windows-server.md)  
[Utilizzo del proxy dell'applicazione Web](assetId:///b607b717-2172-4271-98d1-fa8162e0bb2e)  
  


