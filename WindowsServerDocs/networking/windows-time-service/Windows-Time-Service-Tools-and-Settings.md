---
ms.assetid: 6086947f-f9ef-4e18-9f07-6c7c81d7002c
title: Strumenti e impostazioni del servizio Ora di Windows
description: ''
author: shortpatti
ms.author: pashort
manager: dougkim
ms.date: 10/16/2018
ms.topic: article
ms.prod: windows-server
ms.technology: networking
ms.openlocfilehash: 84d10c30d42e92d325475a1143c85acce7456a80
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/27/2019
ms.locfileid: "71395678"
---
# <a name="windows-time-service-tools-and-settings"></a>Strumenti e impostazioni del servizio Ora di Windows
>Si applica a: Windows Server 2016, Windows Server 2012 R2, Windows Server 2012, Windows 10 o versione successiva

In questo argomento vengono fornite informazioni sugli strumenti e le impostazioni per il servizio ora di Windows (W32Time). 

Se si vuole solo sincronizzare l'ora per un computer client aggiunto al dominio, vedere [configurare un computer client per la sincronizzazione automatica dell'ora di dominio](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/cc816884%28v%3dws.10%29). Per ulteriori argomenti su come configurare il servizio ora di Windows, vedere [dove trovare le informazioni di configurazione del servizio ora di Windows](https://docs.microsoft.com/windows-server/networking/windows-time-service/windows-time-service-top).  

> [!CAUTION]  
> Non utilizzare il comando net time per configurare o impostare l'ora in cui è in esecuzione il servizio ora di Windows.  
>
> Inoltre, nei computer meno recenti che eseguono Windows XP o versioni precedenti, il comando net time/QUERYSNTP Visualizza il nome di un server NTP (Network Time Protocol) con cui un computer è configurato per la sincronizzazione, ma il server NTP viene usato solo quando il client Time del computer è configurato come NTP o AllSync. Il comando è stato deprecato.  

La maggior parte dei computer membri del dominio hanno un tipo di client Time NT5DS, il che significa che sincronizzano l'ora dalla gerarchia di dominio. L'unica eccezione tipica è il controller di dominio che funziona come master operazioni dell'emulatore del controller di dominio primario (PDC) del dominio radice della foresta, che in genere è configurato per sincronizzare l'ora con un'origine ora esterna. Per visualizzare la configurazione del client temporale di un computer, eseguire il comando w32tm/query/configurazione da un prompt dei comandi con privilegi elevati in a partire da Windows Server 2008 e Windows Vista e leggere la riga del **tipo** nell'output del comando. Per ulteriori informazioni, vedere [come funziona il servizio ora di Windows](https://docs.microsoft.com/windows-server/networking/windows-time-service/How-the-Windows-Time-Service-Works). È possibile eseguire il comando **reg query HKLM\SYSTEM\CurrentControlSet\Services\W32Time\Parameters** e leggere il valore di **NtpServer** nell'output del comando.  

> [!IMPORTANT]  
> Prima di Windows Server 2016, il servizio W32Time non è stato progettato per soddisfare le esigenze dell'applicazione in termini di tempo.  Tuttavia, gli aggiornamenti a Windows Server 2016 consentono ora di implementare una soluzione per l'accuratezza del 1 MS nel dominio.  Per ulteriori informazioni, vedere l' [ora esatta](accurate-time.md) e [il limite del supporto di Windows 2016 per configurare il servizio ora di Windows per ambienti ad alta precisione](https://docs.microsoft.com/windows-server/networking/windows-time-service/support-boundary) .  

## <a name="windows-time-service-tools"></a>Strumenti del servizio ora di Windows  
Gli strumenti seguenti sono associati al servizio ora di Windows.  

#### <a name="w32tmexe-windows-time"></a>W32tm. exe: ora di Windows  
**Categoria**  

Questo strumento viene installato come parte delle installazioni predefinite di Windows XP, Windows Vista, Windows 7, Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 e Windows Server 2008 R2.  

**Compatibilità tra versioni**  

Questo strumento funziona nelle installazioni predefinite di Windows XP, Windows Vista, Windows 7, Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 e Windows Server 2008 R2.  

W32tm. exe viene utilizzato per configurare le impostazioni del servizio ora di Windows. Può anche essere usato per diagnosticare i problemi con il servizio ora. W32tm. exe è lo strumento da riga di comando preferito per la configurazione, il monitoraggio o la risoluzione dei problemi del servizio ora di Windows.  

Nelle tabelle seguenti vengono descritti i parametri utilizzati con w32tm. exe.  

**Parametri primari w32tm. exe**  


|                                                                                                                                  Parametro                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Descrizione                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                                                                                                                   W32tm/?                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Guida della riga di comando di W32tm                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|                                                                                                                               /Register w32tm                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Registra il servizio ora per l'esecuzione come servizio e aggiunge la configurazione predefinita al registro di sistema.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|                                                                                                                              /Unregister w32tm                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Annulla la registrazione del servizio ora e rimuove tutte le informazioni di configurazione dal registro di sistema.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|                                                                                 /monitor w32tm<br /><br />[/Domain:<domain name>] [/Computers:<name>[,<name>[,<name>...]]] [/Threads:<num>]                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                 dominio: specifica il dominio da monitorare. Se non si specifica alcun nome di dominio o non si specifica l'opzione Domain o computers, viene utilizzato il dominio predefinito. Questa opzione può essere usata più di una volta.<br /><br />computer: monitora l'elenco di computer specificato. I nomi dei computer sono separati da virgole, senza spazi. Se un nome è preceduto da un'\*', viene considerato come un PDC. Questa opzione può essere usata più di una volta.<br /><br />thread-specifica il numero di computer da analizzare simultaneamente. Il valore predefinito è 3. L'intervallo consentito è 1-50.                                                                                                                                                                                                                                                                                                                                                                                                                 |
|                                                                                                                         w32tm/ntte <NT time epoch>                                                                                                                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Converte un'ora di sistema NT, in (10 ^-7) s intervalli da Oh 1-gen 1601, in un formato leggibile.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|                                                                                                                        w32tm/ntpte <NTP time epoch>                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Converte un valore di ora NTP, in (2 ^-32) s intervalli da Oh 1-gen 1900, in un formato leggibile.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|                                                                               sull'/Resync w32tm<br /><br />[/computer:<computer>]<br /><br />/NOWAIT<br /><br />[/rediscover]<br /><br />[/soft]                                                                               |                                                                                                                                                                                                                                                                                                                                                                      Indica a un computer che deve risincronizzare l'orologio il prima possibile, generando tutte le statistiche di errore accumulate.<br /><br />computer:<computer>-specifica il computer che deve essere risincronizzato. Se non è specificato, il computer locale viene risincronizzato.<br /><br />NOWAIT: non attendere che si verifichi la risincronizzazione; viene restituito immediatamente. In caso contrario, attendere il completamento della risincronizzazione prima di restituire.<br /><br />nuova individuazione: ririleva la configurazione di rete e individua nuovamente le origini di rete, quindi Risincronizza.<br /><br />risincronizzare temporaneamente utilizzando le statistiche degli errori esistenti. Non utile, fornito per la compatibilità.                                                                                                                                                                                                                                                                                                                                                                      |
|                                                          /stripchart w32tm<br /><br />/computer:<target><br /><br />[/period:<refresh>]<br /><br />[/dataonly]<br /><br />[/Samples:<count>]<br/><br/>[/rdtsc]<br/>                                                          |                            Visualizza un grafico a strisce dell'offset tra il computer e un altro computer.<br /><br />computer:<target>-il computer con cui misurare l'offset.<br /><br />periodo:<refresh>-tempo tra i campioni, in secondi. Il valore predefinito è 2s.<br /><br />DataOnly: Visualizza solo i dati senza grafica.<br /><br />Esempi:<count> raccogliere <count> esempi, quindi arrestare. Se non è specificato, gli esempi verranno raccolti fino a quando non si preme **CTRL + C** .<br/><br/>RDTSC: per ogni esempio, questa opzione consente di stampare i valori delimitati da virgole insieme alle intestazioni RdtscStart, RdtscEnd, FILETIME, RoundtripDelay, NtpOffset anziché all'immagine di testo.<br/><ul><li>[RdtscStart: valore di RDTSC (Read timestamp Counter)](https://en.wikipedia.org/wiki/Time_Stamp_Counter) raccolto immediatamente prima della generazione della richiesta NTP.</li><li>RdtscEnd: valore di RDTSC (Read TimeStamp Counter) raccolto subito dopo la ricezione e l'elaborazione della risposta NTP.</li><li>FILETIME: valore di FILETIME locale usato nella richiesta NTP.</li><li>RoundtripDelay: tempo trascorso in secondi tra la generazione della richiesta NTP e l'elaborazione della risposta NTP ricevuta, calcolata in base ai calcoli del round trip NTP.</li><li>NTPOffset: offset dell'ora in secondi tra il computer locale e il server NTP, calcolato come per i calcoli di offset NTP.</li></ul>                             |
| /config w32tm<br /><br />[/computer:<target>]<br /><br />/Update<br /><br />[/manualpeerlist:<peers>]<br /><br />[/syncfromflags:<source>]<br /><br />[/LocalClockDispersion:<seconds>]<br /><br />[/reliable: (Sì&#124;no)]<br /><br />[/LargePhaseOffset:<milliseconds>] | computer:<target>-regola la configurazione della <target>. Se non specificato, il valore predefinito è il computer locale.<br /><br />Update: notifica al servizio ora che la configurazione è stata modificata, causando l'effetto delle modifiche.<br /><br />manualpeerlist:<peers>-imposta l'elenco dei peer manuali su <peers>, ovvero un elenco delimitato da spazi di indirizzi IP e/o DNS. Quando si specificano più peer, questa opzione deve essere racchiusa tra virgolette.<br /><br />syncfromflags:<source>-imposta le origini da cui il client NTP deve sincronizzare. <source> deve essere un elenco di parole chiave separate da virgole (senza distinzione tra maiuscole e minuscole):<br /><br />MANUAL: include i peer dall'elenco dei peer manuali.<br /><br />DOMHIER-sincronizza da un controller di dominio nella gerarchia di domini.<br /><br />LocalClockDispersion:<seconds>: configura l'accuratezza del clock interno che verrà assunto da W32Time quando non è in grado di acquisire tempo dalle origini configurate.<br /><br />affidabile: (Sì&#124;no)-impostare se il computer è un'origine ora affidabile.<br /><br />Questa impostazione è significativa solo nei controller di dominio.<br /><br />Sì, questo computer è un servizio ora affidabile.<br /><br />NO-questo computer non è un servizio ora affidabile.<br /><br />LargePhaseOffset:<milliseconds>-imposta la differenza di tempo tra l'ora locale e la rete in cui W32Time considererà un picco. |
|                                                                                                                                  /TZ w32tm                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Visualizza le impostazioni correnti del fuso orario.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                                                                                                  /dumpreg w32tm<br /><br />[/Subkey:<key>]<br /><br />[/computer:<target>]                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Visualizza i valori associati a una chiave del registro di sistema specificata.<br /><br />La chiave predefinita è HKLM\System\CurrentControlSet\Services\W32Time<br /><br />(chiave radice per il servizio ora).<br /><br />sottochiave:<key>-Visualizza i valori associati alla sottochiave <key> della chiave predefinita.<br /><br />computer:<target>-esegue query sulle impostazioni del registro di sistema per <target> computer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|                                                                                  w32tm/query [/computer:<target>] {/Source &#124; /configurazione &#124; &#124; /Peers/status} [/Verbose]                                                                                   |                                                                                                                                                                                                                                                                                                                  Questo parametro è stato reso disponibile per la prima volta nelle versioni client di Windows Vista e Windows Server 2008.<br /><br />Visualizza le informazioni sul servizio ora di Windows di un computer.<br /><br />**computer:<target>** eseguire una query sulle informazioni di **<target>** . Se non è specificato, il valore predefinito è il computer locale.<br /><br />**Source** : Visualizza l'origine dell'ora.<br /><br />**Configurazione** : consente di visualizzare la configurazione del runtime e da dove deriva l'impostazione. In modalità dettagliata visualizzare anche l'impostazione non definita o inutilizzata.<br /><br />**Peers** : Visualizza un elenco di peer e il relativo stato.<br /><br />**stato** : Visualizza lo stato del servizio ora di Windows.<br /><br />**verbose** : impostare la modalità dettagliata per visualizzare altre informazioni.                                                                                                                                                                                                                                                                                                                   |
|                                                                                       w32tm/debug {/Disable &#124; {/Enable/file:<name>/size:<bytes>/Entries:<value> [/truncate]}}                                                                                       |                                                                                                                                                                                                                                                                         Questo parametro è stato reso disponibile per la prima volta nelle versioni client di Windows Vista e Windows Server 2008.<br /><br />Abilitare o disabilitare il log privato del servizio ora di Windows del computer locale.<br /><br />**Disable** : Disabilita il log privato.<br /><br />**Abilita** -Abilita il log privato.<br /><br />**file -   :<name>** -specificare il nome file assoluto.<br />**dimensioni -   :<bytes>** specificare le dimensioni massime per la registrazione circolare.<br />-   **voci:<value>** -contiene un elenco di flag, specificati in base al numero e separati da virgole, che specificano i tipi di informazioni che devono essere registrate. I numeri validi sono compresi tra 0 e 300. Un intervallo di numeri è valido, oltre ai numeri singoli, ad esempio 0-100103106. Il valore 0-300 è per la registrazione di tutte le informazioni.<br /><br />**troncare** : troncare il file, se esistente.                                                                                                                                                                                                                                                                          |

---  
Per ulteriori informazioni su **w32tm. exe**, vedere Guida e supporto tecnico in Windows XP, Windows Vista, Windows 7, windows Server 2003, windows Server 2003 R2, windows Server 2008 e windows Server 2008 R2.  

## <a name="windows-time-service-registry-entries"></a>Voci del registro di sistema del servizio ora di Windows
Le seguenti voci del registro di sistema sono associate al servizio ora di Windows.  

Queste informazioni vengono fornite come riferimento da utilizzare per la risoluzione dei problemi o per verificare che siano applicate le impostazioni richieste. Si consiglia di non modificare direttamente il registro di sistema, a meno che non esistano altre alternative. Modifiche al Registro di sistema non vengono convalidate dall'editor del Registro di sistema o da Windows prima di applicarle, e di conseguenza, possono essere archiviati i valori non corretti. Ciò può causare errori irreversibili nel sistema.  

Quando possibile, utilizzare criteri di gruppo o altri strumenti di Windows, ad esempio Microsoft Management Console (MMC) per eseguire attività, piuttosto che modificare direttamente il Registro di sistema. Se è necessario modificare il Registro di sistema, usare la massima cautela.  

> [!WARNING]  
> Alcuni dei valori predefiniti configurati nel file di modello amministrativo di sistema (System. adm) per le impostazioni dell'oggetto Criteri di gruppo (GPO) sono diversi dalle voci del registro di sistema corrispondenti. Se si prevede di utilizzare un oggetto Criteri di gruppo per configurare qualsiasi impostazione ora di Windows, assicurarsi di esaminare i [valori predefiniti per le impostazioni criteri di gruppo servizio ora di Windows sono diverse dalle voci del registro di sistema del servizio ora di Windows corrispondenti in Windows Server 2003](https://go.microsoft.com/fwlink/?LinkId=186066). Questo problema si applica a Windows Server 2008 R2, Windows Server 2008, Windows Server 2003 R2 e Windows Server 2003.  

Molte voci del registro di sistema per il servizio ora di Windows sono identiche a quelle dell'impostazione Criteri di gruppo con lo stesso nome. Le impostazioni Criteri di gruppo corrispondono alle voci del registro di sistema con lo stesso nome che si trova in:  

>**\\ HKLM\SYSTEM\CurrentControlSet\Services\W32Time**


Sono presenti diverse chiavi del registro di sistema in questo percorso del registro di sistema. Le impostazioni temporali di Windows sono archiviate in valori in tutte le chiavi seguenti:

* [Parametri](#hklmsystemcurrentcontrolsetservicesw32timeparameters)
* [Config](#hklmsystemcurrentcontrolsetservicesw32timeconfig)
* [NtpClient](#hklmsystemcurrentcontrolsetservicesw32timetimeprovidersntpclient)
* [NtpServer](#hklmsystemcurrentcontrolsetservicesw32timetimeprovidersntpserver)

Molti dei valori nella sezione W32Time del registro di sistema vengono usati internamente da W32Time per archiviare le informazioni. Questi valori non devono essere modificati manualmente in qualsiasi momento. Non modificare alcuna impostazione in questa sezione, a meno che non si abbia familiarità con l'impostazione e si sia certi che il nuovo valore funzioni come previsto. Le seguenti voci del registro di sistema si trovano in:

**HKLM\SYSTEM\CurrentControlSet\Services\W32Time**  

Quando si crea un criterio, le impostazioni vengono configurate nel percorso seguente, che non ha la precedenza sulla posizione successiva:

**HKLM\SOFTWARE\Policies\Microsoft\Windows\W32time**

La chiave W32Time viene creata con i criteri.  Quando si rimuove il criterio, viene rimossa anche questa chiave.

Il percorso predefinito è il seguente:

**HKLM\SYSTEM\CurrentControlSet\Services\W32time**

Alcuni parametri vengono archiviati nei Tick del clock nel registro di sistema e alcuni sono in pochi secondi. Per convertire l'ora dai Tick del clock in secondi:  

-   1 minuto = 60 sec  

-   1 sec = 1000 ms  

-   1 MS = 10.000 cicli di clock in un sistema Windows, come descritto in [proprietà DateTime. Ticks](https://docs.microsoft.com/dotnet/api/system.datetime.ticks?redirectedfrom=MSDN&view=netframework-4.7.2#System_DateTime_Ticks).  

Ad esempio, 5 minuti diventeranno 5\*60\*1000\*10000 = 3 miliardi cicli di clock. 

Tutte le versioni includono Windows 7, Windows 8, Windows 10, Windows Server 2008 e Windows Server 2008 R2, Windows Server 2012, Windows Server 2012R2, Windows Server 2016.  Alcune voci sono disponibili solo nelle versioni più recenti di Windows.

#### <a name="hklmsystemcurrentcontrolsetservicesw32timeparameters"></a>HKLM\SYSTEM\CurrentControlSet\Services\W32Time\Parameters

|          Voce del registro di sistema          | Versione |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Descrizione                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|----------------------------------|---------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| AllowNonstandardModeCombinations |   Tutte   |                                                                                                                                                                                                                                                                                                                                                                                                              Voce indica che le combinazioni di modalità non standard sono consentite nella sincronizzazione tra peer. Il valore predefinito per i membri del dominio è 1. Il valore predefinito per i client e i server autonomi è 1.                                                                                                                                                                                                                                                                                                                                                                                                              |
|            NtpServer             |   Tutte   | Voce specifica un elenco delimitato da spazi di peer da cui un computer ottiene i timestamp, costituito da uno o più nomi DNS o indirizzi IP per riga. Ogni nome DNS o indirizzo IP elencato deve essere univoco. I computer connessi a un dominio devono eseguire la sincronizzazione con un'origine ora più affidabile, ad esempio il clock ufficiale del tempo degli Stati Uniti.  <ul><li>SpecialInterval 0x01 </li><li>UseAsFallbackOnly 0x02</li><li>0x04 SymmetricActive-per altre informazioni su questa modalità, vedere [Windows Time Server: 3,3 modalità di funzionamento](https://go.microsoft.com/fwlink/?LinkId=208012).</li><li>Client 0x08</li></ul><br />Non esiste alcun valore predefinito per questa voce del registro di sistema nei membri del dominio. Il valore predefinito nei client e nei server autonomi è Time. Windows. com, 0x1.<br /><br />Nota: per ulteriori informazioni sui server NTP disponibili, vedere [l'articolo 262680 della Microsoft Knowledge base, un elenco dei server SNTP (Simple Network Time Protocol) disponibili su Internet.](https://support.microsoft.com/help/262680/a-list-of-the-simple-network-time-protocol-sntp-time-servers-that-are) |
|            ServiceDll            |   Tutte   |                                                                                                                                                                                                                                                                                                                                                              La voce viene gestita da W32Time. Contiene dati riservati utilizzati dal sistema operativo Windows e le eventuali modifiche apportate a questa impostazione possono provocare risultati imprevedibili. Il percorso predefinito per questa DLL sia per i membri del dominio che per i client e i server autonomi è%windir%\System32\W32Time.dll.                                                                                                                                                                                                                                                                                                                                                               |
|           ServiceMain            |   Tutte   |                                                                                                                                                                                                                                                                                                                                                       La voce viene gestita da W32Time. Contiene dati riservati utilizzati dal sistema operativo Windows e le eventuali modifiche apportate a questa impostazione possono provocare risultati imprevedibili. Il valore predefinito per i membri del dominio è SvchostEntry_W32Time. Il valore predefinito nei client e nei server autonomi è SvchostEntry_W32Time.  "                                                                                                                                                                                                                                                                                                                                                       |
|               Tipo               |   Tutte   |                                                                                                                                                                                                                                  Voce indica i peer da cui accettare la sincronizzazione:  <ul><li>**Nosync**. Il servizio ora non viene sincronizzato con altre origini.</li><li>**NTP.** Il servizio ora viene sincronizzato dai server specificati in **NtpServer**. voce del registro di sistema.</li><li>**NT5DS**. Il servizio ora viene sincronizzato dalla gerarchia di domini.  </li><li>**AllSync**. Il servizio ora usa tutti i meccanismi di sincronizzazione disponibili.  </li></ul>Il valore predefinito per i membri del dominio è **NT5DS**. Il valore predefinito nei client e nei server autonomi è **NTP**.                                                                                                                                                                                                                                   |

---
#### <a name="hklmsystemcurrentcontrolsetservicesw32timeconfig"></a>HKLM\SYSTEM\CurrentControlSet\Services\W32Time\Config

|    Voce del registro di sistema     |          Versione           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Descrizione                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|-----------------------|----------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|     AnnounceFlags     |            Tutte             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Entry controlla se il computer è contrassegnato come server di ora affidabile. Un computer non è contrassegnato come affidabile a meno che non sia anche contrassegnato come server di ora.<br /> -0x00 non è un server di ora  <br /> -Server 0x01 always Time  <br /> -0x02 tempo automatico server  <br /> -Server ora di 0x04 sempre affidabile  <br /> -0x08 tempo affidabile automatico server  <br />Il valore predefinito per i membri del dominio è 10. Il valore predefinito per i client e i server autonomi è 10.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|     EventLogFlags     |            Tutte             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Entry controlla gli eventi registrati dal servizio Time.  <br />-Salto temporale: 0x1  <br />-Modifica origine: 0x2  <br />Il valore predefinito per i membri del dominio è 2. Il valore predefinito nei client e nei server autonomi è 2.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| FrequencyCorrectRate  |            Tutte             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Entry controlla la velocità con cui viene corretto il clock. Se questo valore è troppo piccolo, il clock è instabile e si corregge. Se il valore è troppo grande, la sincronizzazione del clock richiede molto tempo. Il valore predefinito per i membri del dominio è 4. Il valore predefinito nei client e nei server autonomi è 4.  <br /><br />Si noti che 0 è un valore non valido per la voce del registro di sistema FrequencyCorrectRate. Nei computer Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 e Windows Server 2008 R2, se il valore è impostato su 0, il servizio ora di Windows lo cambierà automaticamente in 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|      HoldPeriod       |            Tutte             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Entry controlla il periodo di tempo in cui il rilevamento dei picchi è disabilitato per portare rapidamente l'orologio locale nella sincronizzazione. Un picco è un esempio di tempo che indica che il tempo è disattivato per un certo numero di secondi e viene in genere ricevuto dopo la restituzione coerente degli esempi di tempo valido. Il valore predefinito per i membri del dominio è 5. Il valore predefinito nei client e nei server autonomi è 5.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|   LargePhaseOffset    |            Tutte             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Voce specifica che un offset dell'ora maggiore o uguale a questo valore in 10<sup>-7</sup> secondi viene considerato un picco. Un'interferenza della rete, ad esempio una grande quantità di traffico, può causare un picco. Un picco verrà ignorato a meno che non venga mantenuto per un lungo periodo di tempo. Il valore predefinito per i membri del dominio è 50 milioni. Il valore predefinito nei client e nei server autonomi è 50 milioni.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|     LastClockRate     |            Tutte             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           La voce viene gestita da W32Time. Contiene dati riservati utilizzati dal sistema operativo Windows e le eventuali modifiche apportate a questa impostazione possono provocare risultati imprevedibili. Il valore predefinito per i membri del dominio è 156250. Il valore predefinito nei client e nei server autonomi è 156250.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| LocalClockDispersion  |            Tutte             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Entry controlla la dispersione (in secondi) che è necessario presupporre quando l'unica origine ora è il clock CMOS incorporato. Il valore predefinito per i membri del dominio è 10. Il valore predefinito nei client e nei server autonomi è 10.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| MaxAllowedPhaseOffset |            Tutte             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Voce specifica l'offset massimo (in secondi) per il quale W32Time tenta di regolare l'orologio del computer utilizzando la frequenza di clock. Quando l'offset supera questa frequenza, W32Time imposta direttamente l'orologio del computer. Il valore predefinito per i membri del dominio è 300. Il valore predefinito per i client e i server autonomi è 1.  [Per ulteriori informazioni, vedere di seguito](#maxallowedphaseoffset-information).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|     MaxClockRate      |            Tutte             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          La voce viene gestita da W32Time. Contiene dati riservati utilizzati dal sistema operativo Windows e le eventuali modifiche apportate a questa impostazione possono provocare risultati imprevedibili. Il valore predefinito per i membri del dominio è 155860. Il valore predefinito per i client e i server autonomi è 155860.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| MaxNegPhaseCorrection |            Tutte             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Entry specifica la correzione più grande del tempo negativo in secondi eseguita dal servizio. Se il servizio determina che è necessaria una modifica di dimensioni maggiori, viene registrato un evento. Caso speciale: 0xFFFFFFFF indica sempre la correzione del tempo. Il valore predefinito per i membri del dominio è 0xFFFFFFFF. Il valore predefinito per i client e i server autonomi è 54.000 (15 ore).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|    MaxPollInterval    |            Tutte             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Entry specifica l'intervallo massimo, in log2 secondi, consentito per l'intervallo di polling del sistema. Si noti che, mentre un sistema deve eseguire il polling in base all'intervallo pianificato, un provider può rifiutare di produrre esempi quando richiesto. Il valore predefinito per i controller di dominio è 10. Il valore predefinito per i membri del dominio è 15. Il valore predefinito per i client e i server autonomi è 15.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| MaxPosPhaseCorrection |            Tutte             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Entry specifica la correzione del tempo positivo più grande in secondi eseguita dal servizio. Se il servizio determina che è necessaria una modifica di dimensioni maggiori, viene registrato un evento. Caso speciale: 0xFFFFFFFF indica sempre la correzione del tempo. Il valore predefinito per i membri del dominio è 0xFFFFFFFF. Il valore predefinito per i client e i server autonomi è 54.000 (15 ore).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|     MinClockRate      |            Tutte             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          La voce viene gestita da W32Time. Contiene dati riservati utilizzati dal sistema operativo Windows e le eventuali modifiche apportate a questa impostazione possono provocare risultati imprevedibili. Il valore predefinito per i membri del dominio è 155860. Il valore predefinito per i client e i server autonomi è 155860.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|    MinPollInterval    |            Tutte             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Entry specifica l'intervallo più piccolo, in log2 secondi, consentito per l'intervallo di polling del sistema. Si noti che, sebbene un sistema non richieda esempi più frequentemente, un provider può produrre esempi in momenti diversi dall'intervallo pianificato. Il valore predefinito per i controller di dominio è 6. Il valore predefinito per i membri del dominio è 10. Il valore predefinito per i client e i server autonomi è 10.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|   PhaseCorrectRate    |            Tutte             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Entry controlla la frequenza di correzione dell'errore di fase. Se si specifica un valore ridotto, l'errore di fase viene corretto rapidamente, ma il clock potrebbe diventare instabile. Se il valore è troppo grande, per correggere l'errore di fase è necessario più tempo. <br /><br />Il valore predefinito per i membri del dominio è 1. Il valore predefinito nei client e nei server autonomi è 7.<br /><br />Nota: 0 non è un valore valido per la voce del registro di sistema PhaseCorrectRate. Nei computer Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 e Windows Server 2008 R2, se il valore è impostato su 0, il servizio ora di Windows lo modifica automaticamente in 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|   PollAdjustFactor    |            Tutte             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Entry controlla la decisione di aumentare o diminuire l'intervallo di polling per il sistema. Maggiore è il valore, minore è la quantità di errore che causa la riduzione dell'intervallo di polling. Il valore predefinito per i membri del dominio è 5. Il valore predefinito nei client e nei server autonomi è 5.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|   SpikeWatchPeriod    |            Tutte             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Voce specifica la quantità di tempo per cui un offset sospetto deve essere mantenuto prima che venga accettato come corretto (in secondi). Il valore predefinito per i membri del dominio è 900. Il valore predefinito nei client e nelle workstation autonomi è 900.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|  TimeJumpAuditOffset  |            Tutte             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Unsigned Integer che indica la soglia di controllo dei salti temporali, in secondi. Se il servizio ora regola il clock locale impostando l'orologio direttamente e la correzione dell'ora è superiore a questo valore, il servizio ora registra un evento di controllo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|    UpdateInterval     |            Tutte             | Voce specifica il numero di cicli di clock tra le regolazioni della correzione della fase. Il valore predefinito per i controller di dominio è 100. Il valore predefinito per i membri del dominio è 30.000. Il valore predefinito per i client e i server autonomi è 360.000.  <br /><br />**Nota**: zero è un valore non valido per la voce del registro di sistema UpdateInterval. Nei computer che eseguono Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 e Windows Server 2008 R2, se il valore è impostato su 0, il servizio ora di Windows lo modifica automaticamente in 1.<br /><br />Le seguenti tre voci del registro di sistema non fanno parte della configurazione predefinita di W32Time, ma possono essere aggiunte al registro di sistema per ottenere maggiori funzionalità di registrazione. Le informazioni registrate nel registro eventi di sistema possono essere modificate modificando il valore per l'impostazione EventLogFlags nel Editor oggetti Criteri di gruppo. Per impostazione predefinita, il servizio ora crea un accesso Visualizzatore eventi ogni volta che passa a una nuova origine dell'ora.<br /><br />**Avviso**: alcuni dei valori predefiniti configurati nel file di modello amministrativo di sistema (System. adm) per le impostazioni dell'oggetto Criteri di gruppo (GPO) sono diversi dalle voci del registro di sistema corrispondenti. Se si prevede di utilizzare un oggetto Criteri di gruppo per configurare qualsiasi impostazione ora di Windows, assicurarsi di esaminare i [valori predefiniti per le impostazioni criteri di gruppo servizio ora di Windows sono diverse dalle voci del registro di sistema del servizio ora di Windows corrispondenti in Windows Server 2003](https://go.microsoft.com/fwlink/?LinkId=186066). Questo problema si applica a Windows Server 2008 R2, Windows Server 2008, Windows Server 2003 R2 e Windows Server 2003. |
|  UtilizeSslTimeData   | Post Windows 10 Build 1511 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             La voce 1 indica che W32Time utilizzerà più timestamp SSL per inizializzare un clock non accurato.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |

---
Per abilitare la registrazione W32Time, è necessario aggiungere le seguenti voci del registro di sistema:  

|Voce del registro di sistema|Versione|Descrizione|
|------------------------------------|---------------|----------------------------|
|FileLogEntries|Tutte|Entry controlla la quantità di voci create nel file di log dell'ora di Windows. Il valore predefinito è None, che non registra alcuna attività temporale di Windows. I valori validi sono compresi tra 0 e 300. Questo valore non influisce sulle voci del registro eventi create normalmente da Windows Time|
|FileLogName|Tutte|Entry controlla il percorso e il nome file del registro ora di Windows. Il valore predefinito è Blank e non deve essere modificato a meno che non venga modificato **FileLogEntries** . Un valore valido è un percorso completo e un nome file che verrà utilizzato da Windows per creare il file di log. Questo valore non influisce sulle voci del registro eventi create normalmente dall'ora di Windows.  |
|FileLogSize|Tutte|Entry controlla il comportamento di registrazione circolare dei file di log temporali di Windows. Quando **FileLogEntries** e **FileLogName** sono definiti, entry definisce la dimensione, in byte, per consentire al file di log di raggiungere prima di sovrascrivere le voci di log meno recenti con nuove voci. Usare 1 milione o un valore più grande per questa impostazione. Questo valore non influisce sulle voci del registro eventi create normalmente dall'ora di Windows.  |

---

#### <a name="hklmsystemcurrentcontrolsetservicesw32timetimeprovidersntpclient"></a>HKLM\SYSTEM\CurrentControlSet\Services\W32Time\TimeProviders\NtpClient

|Voce del registro di sistema|Versione|Descrizione|
|------------------------------------|---------------|----------------------------|
|AllowNonstandardModeCombinations|Tutte|Voce indica che le combinazioni di modalità non standard sono consentite nella sincronizzazione tra peer. Il valore predefinito per i membri del dominio è 1. Il valore predefinito per i client e i server autonomi è 1.|
|CompatibilityFlags|Tutte|Entry specifica i valori e i flag di compatibilità seguenti: <br /><br />-DispersionInvalid: 0x00000001  <br />-IgnoreFutureRefTimeStamp: 0x00000002  <br /> -AutodetectWin2K: 0x80000000  <br />-AutodetectWin2KStage2:0x40000000  <br /><br />Il valore predefinito per i membri del dominio è 0x80000000. Il valore predefinito per i client e i server autonomi è 0x80000000.  |
|CrossSiteSyncFlags|Tutte|Voce determina se il servizio sceglie i partner di sincronizzazione all'esterno del dominio del computer. Le opzioni e i valori sono:  <br /><br />-None: 0  <br />-PdcOnly: 1  <br />-Tutti: 2  <br /><br />Questo valore viene ignorato se il valore NT5DS non è impostato. Il valore predefinito per i membri del dominio è 2. Il valore predefinito per i client e i server autonomi è 2.  |
|NomeDLL|Tutte|Entry specifica il percorso della DLL per il provider di servizi temporali.  <br /><br />Il percorso predefinito per questa DLL sia per i membri del dominio che per i client e i server autonomi è%windir%\System32\W32Time.dll.|
|Enabled|Tutte|Voce indica se il provider NtpClient è abilitato nel servizio ora corrente.  <br /><ul><li>Sì 1</li><li>Nessun 0</li></ul>Il valore predefinito per i membri del dominio è 1. Il valore predefinito nei client e nei server autonomi è 1.|
|EventLogFlags|Tutte|Entry specifica gli eventi registrati dal servizio ora di Windows.<ul><li>modifiche della raggiungibilità di 0x1</li><li>asimmetria di esempio 0x2 di grandi dimensioni (applicabile solo a Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 e Windows Server 2008 R2)</li></ul>Il valore predefinito per i membri del dominio è 0x1. Il valore predefinito nei client e nei server autonomi è 0x1.|
|InputProvider|Tutte|Voce indica se abilitare NtpClient come InputProvider, che ottiene le informazioni sull'ora da NtpServer. NtpServer è un server di tempo che risponde alle richieste temporali dei client sulla rete restituendo esempi di tempo utili per la sincronizzazione dell'orologio locale. <ul><li>Sì = 1  </li><li>No = 0 </li></ul><p>Valore predefinito per i membri del dominio e i client autonomi: 1  |
|LargeSampleSkew|Tutte|Entry specifica la differenza di esempio di grandi dimensioni per la registrazione in secondi. Per garantire la conformità alle specifiche di sicurezza e Exchange Commission (SEC), questo deve essere impostato su tre secondi. Gli eventi verranno registrati per questa impostazione solo quando EventLogFlags è configurato in modo esplicito per l'asimmetria di esempio 0x2 large. Il valore predefinito per i membri del dominio è 3. Il valore predefinito nei client e nei server autonomi è 3.  |
|ResolvePeerBackOffMaxTimes|Tutte|Voce specifica il numero massimo di volte in cui raddoppiare l'intervallo di attesa quando i tentativi ripetuti di individuare un peer per la sincronizzazione con hanno esito negativo. Un valore pari a zero indica che l'intervallo di attesa è sempre il minimo. Il valore predefinito per i membri del dominio è 7. Il valore predefinito nei client e nei server autonomi è 7. |
|ResolvePeerBackoffMinutes|Tutte|Voce specifica l'intervallo iniziale di attesa, in minuti, prima di tentare di individuare un peer con cui eseguire la sincronizzazione. Il valore predefinito per i membri del dominio è 15. Il valore predefinito nei client e nei server autonomi è 15.  |
|SpecialPollInterval|Tutte|Entry specifica l'intervallo di polling speciale in secondi per i peer manuali. Quando il flag SpecialInterval 0x1 è abilitato, W32Time usa questo intervallo di polling invece di un intervallo di polling determinato dal sistema operativo. Il valore predefinito per i membri del dominio è 3.600. Il valore predefinito nei client e nei server autonomi è 604.800.<br/><br/>Una novità per la build 1702, SpecialPollInterval è contenuta nei valori del registro di sistema MinPollInterval e MaxPollInterval config.|
|SpecialPollTimeRemaining|Tutte|La voce viene gestita da W32Time. Contiene dati riservati utilizzati dal sistema operativo Windows. Specifica il tempo in secondi prima che W32Time venga risincronizzato dopo il riavvio del computer. Eventuali modifiche apportate a questa impostazione possono provocare risultati imprevedibili. Il valore predefinito sia per i membri del dominio sia per i client e i server autonomi viene lasciato vuoto.  |

---

#### <a name="hklmsystemcurrentcontrolsetservicesw32timetimeprovidersntpserver"></a>HKLM\SYSTEM\CurrentControlSet\Services\W32Time\TimeProviders\NtpServer

|Voce del registro di sistema|Versione|Descrizione|
|------------------------------------|---------------|----------------------------|
|AllowNonstandardModeCombinations|Tutte|Voce indica che le combinazioni di modalità non standard sono consentite nella sincronizzazione tra client e server. Il valore predefinito per i membri del dominio è 1. Il valore predefinito per i client e i server autonomi è 1.|
|NomeDLL|Tutte|Entry specifica il percorso della DLL per il provider di servizi temporali.<br /><br />Il percorso predefinito per questa DLL sia per i membri del dominio che per i client e i server autonomi è%windir%\System32\W32Time.dll.  |
|Enabled|Tutte|Voce indica se il provider NtpServer è abilitato nel servizio ora corrente. <ul><li>Sì 1</li><li>Nessun 0</li></ul>Il valore predefinito per i membri del dominio è 1. Il valore predefinito nei client e nei server autonomi è 1.  |
|InputProvider|Tutte|Voce indica se abilitare NtpClient come InputProvider, che ottiene le informazioni sull'ora da NtpServer. NtpServer è un server di tempo che risponde alle richieste temporali dei client sulla rete restituendo esempi di tempo utili per la sincronizzazione dell'orologio locale. <ul><li>Sì = 1  </li><li>No = 0 </li></ul><p>Valore predefinito per i membri del dominio e i client autonomi: 1  |

---

#### <a name="maxallowedphaseoffset-information"></a>Informazioni MaxAllowedPhaseOffset
Per consentire a W32Time di impostare il clock del computer gradualmente, l'offset deve essere minore del valore di **MaxAllowedPhaseOffset** e soddisfare l'equazione seguente allo stesso tempo:  

* Windows Server 2016 e versioni successive:
   ```  
    |CurrentTimeOffset| / (16*PhaseCorrectRate*pollIntervalInSeconds) <= SystemClockRate / 2  
   ``` 
* Windows Server 2012 R2 e versioni precedenti:
   ```  
   |CurrentTimeOffset| / (PhaseCorrectRate*UpdateInterval) <= SystemClockRate / 2  
   ``` 
Il valore di **CurrentTimeOffset** viene misurato in tick del clock, dove 1 ms = 10.000 Clock Ticks in un sistema Windows.  

**SystemClockRate** e **PhaseCorrectRate** vengono misurati anche in tick dell'orologio. Per ottenere il valore **SystemClockRate** , è possibile usare il comando seguente e convertirlo da secondi a cicli di clock usando la formula di secondi * 1000\*10000:  

```  
W32tm /query /status /verbose  
ClockRate: 0.0156000s  
```  

**SystemclockRate** è la velocità dell'orologio nel sistema. Utilizzando 156000 secondi come esempio, il valore **SystemclockRate** è = 0,0156000 \* 1000 \* 10000 = 156000 Ticks Clock.  

**MaxAllowedPhaseOffset** è anche in secondi. Per convertirlo in tick del clock, moltiplicare **MaxAllowedPhaseOffset**\*1000\*10000.  

Gli esempi seguenti illustrano come applicare questi calcoli quando si usa Windows Server 2012 R2 o una versione precedente.

**Esempio 1**: l'ora è diversa da 4 minuti (ad esempio, l'ora è 11:05 e l'esempio di tempo ricevuto da un peer e ritiene che sia corretto è 11:09).
  
```
phasecorrectRate = 1  

UpdateInterval = 30000 (clock ticks)  

systemclockRate = 156000 (clock ticks)  

MaxAllowedPhaseOffset = 10min = 600 seconds = 600*1000\*10000=6000000000 clock ticks  

|currentTimeOffset| = 4mins = 4*60\*1000\*10000 = 2400000000 ticks  

Is CurrentTimeOffset <= MaxAllowedPhaseOffset?  

2400000000 <= 6000000000 = TRUE  
```

E soddisfa l'equazione precedente? 

```
(|CurrentTimeOffset| / (PhaseCorrectRate*UpdateInterval) <= SystemClockRate / 2)  

Is 2,400,000,000 / (30000*1) <= 156000/2  

Is 80,000 <= 78,000  

NO/FALSE  
```  

Quindi, W32tm imposterà immediatamente il clock.  

> [!NOTE]  
> In questo caso, se si vuole impostare lentamente il clock, è necessario modificare anche i valori di **PhaseCorrectRate** o **UpdateInterval** nel registro di sistema per assicurarsi che il risultato dell'equazione sia **true**.  

**Esempio 2**: l'ora è diversa da 3 minuti. 
 
```  
phasecorrectRate = 1  

UpdateInterval = 30000 (clock ticks)  

systemclockRate = 156000 (clock ticks)  

MaxAllowedPhaseOffset = 10min = 600 seconds = 600*1000\*10000=6000000000 clock ticks  

currentTimeOffset = 3mins = 3*60\*1000\*10000 = 1800000000 clock ticks  

Is CurrentTimeOffset <= MaxAllowedPhaseOffset?  

1800000000 <= 6000000000 = TRUE  
```  

E soddisfa l'equazione precedente?

```
(|CurrentTimeOffset| / (PhaseCorrectRate*UpdateInterval) <= SystemClockRate / 2)  

Is 3 mins (1,800,000,000) / (30000*1) <= 156000/2  

Is 60,000 <= 78,000  

YES/TRUE  
```  

In questo caso il clock verrà impostato lentamente.  

## <a name="windows-time-service-group-policy-settings"></a>Impostazioni del servizio ora di Windows Criteri di gruppo  
È possibile configurare la maggior parte dei parametri W32Time usando il Editor oggetti Criteri di gruppo. Ciò include la configurazione di un computer come NTPServer o NTPClient, la configurazione del meccanismo di sincronizzazione dell'ora e la configurazione di un computer come origine ora affidabile.  

> [!NOTE]  
> Le impostazioni Criteri di gruppo per il servizio ora di Windows possono essere configurate nei controller di dominio Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 e Windows Server 2008 R2 e possono essere applicate solo a computer che eseguono Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 e Windows Server 2008 R2.  

È possibile trovare le impostazioni Criteri di gruppo utilizzate per configurare W32Time nello snap-in Editor oggetti Criteri di gruppo nei percorsi seguenti:  

-   Configurazione computer\Modelli Amministrativi\sistema\servizio Time Service  

    Configurare qui **le impostazioni di configurazione globali** .  

-   Configurazione computer\Modelli Amministrativi\sistema\servizio tempo Service\Time provider  

    Configurare le impostazioni del **client NTP Windows** qui.  

    Abilitare il **client NTP Windows** qui.  

    Abilitare il **server NTP Windows** qui.  

> [!WARNING]  
> Alcuni dei valori predefiniti configurati nel file di modello amministrativo di sistema (System. adm) per le impostazioni dell'oggetto Criteri di gruppo (GPO) sono diversi dalle voci del registro di sistema corrispondenti. Se si prevede di utilizzare un oggetto Criteri di gruppo per configurare qualsiasi impostazione ora di Windows, assicurarsi di esaminare i [valori predefiniti per le impostazioni criteri di gruppo servizio ora di Windows sono diverse dalle voci del registro di sistema del servizio ora di Windows corrispondenti in Windows Server 2003](https://go.microsoft.com/fwlink/?LinkId=186066). Questo problema si applica a Windows Server 2008 R2, Windows Server 2008, Windows Server 2003 R2 e Windows Server 2003.  

Nella tabella seguente sono elencate le impostazioni di Criteri di gruppo globali associate al servizio ora di Windows e il valore preimpostato associato a ciascuna impostazione. Per ulteriori informazioni su ogni impostazione, vedere le voci del registro di sistema corrispondenti nelle [voci del registro di sistema del servizio ora di Windows](#windows-time-service-registry-entries) in precedenza in questo argomento. Le impostazioni seguenti sono contenute in un singolo oggetto Criteri di gruppo denominato **impostazioni di configurazione globali**.  

**Impostazioni di Criteri di gruppo globali associate all'ora di Windows**  

|Impostazione di Criteri di gruppo|Valore preimpostato|  
|------------------------|------------------|  
|AnnounceFlags|10|  
|EventLogFlags|2|  
|FrequencyCorrectRate|4|  
|HoldPeriod|5|  
|LargePhaseOffset|1280000|  
|LocalClockDispersion|10|  
|MaxAllowedPhaseOffset|300|  
|MaxNegPhaseCorrection|54.000 (15 ore)|  
|MaxPollInterval|15|  
|MaxPosPhaseCorrection|54.000 (15 ore)|  
|MinPollInterval|10|  
|PhaseCorrectRate|7|  
|PollAdjustFactor|5|  
|SpikeWatchPeriod|90|  
|UpdateInterval|100|  

Nella tabella seguente sono elencate le impostazioni disponibili per l'oggetto Criteri di gruppo **Configura client NTP Windows** e i valori predefiniti associati al servizio ora di Windows. Per ulteriori informazioni su ogni impostazione, vedere le voci del registro di sistema corrispondenti nelle [voci del registro di sistema del servizio ora di Windows](#windows-time-service-registry-entries) in precedenza in questo argomento.  

**Impostazioni Criteri di gruppo client NTP associate all'ora di Windows**  

|Impostazione di Criteri di gruppo|Valore predefinito|  
|------------------------|-----------------|  
|NtpServer|Time. Windows. com, 0x1|  
|Tipo|Opzioni predefinite:<br /><br />-   **NTP.** Utilizzare nei computer che non fanno parte di un dominio.<br />-   **NT5DS.** Usare nei computer che fanno parte di un dominio.|  
|CrossSiteSyncFlags|2|  
|ResolvePeerBackoffMinutes|15|  
|ResolvePeerBackoffMaxTimes|7|  
|SpecialPollInterval|3600|  
|EventLogFlags|0|  

## <a name="network-ports-used-by-the-windows-time-service"></a>Porte di rete usate dal servizio ora di Windows  
Ora di Windows segue la specifica NTP, che richiede l'uso della porta UDP 123 per tutte le comunicazioni di sincronizzazione dell'ora. Questa porta è riservata da ora di Windows e rimane sempre riservata. Ogni volta che il computer sincronizza l'orologio o fornisce tempo a un altro computer, la comunicazione viene eseguita sulla porta UDP 123.  

> [!NOTE]  
> Se si dispone di un computer con più schede di rete (detto anche computer multihomed), non è possibile abilitare selettivamente il servizio ora di Windows in base alla scheda di rete.  

## <a name="related-information"></a>Informazioni correlate  
Le risorse seguenti contengono informazioni aggiuntive relative a questa sezione.  

-   RFC *1305* nel database IETF RFC  

