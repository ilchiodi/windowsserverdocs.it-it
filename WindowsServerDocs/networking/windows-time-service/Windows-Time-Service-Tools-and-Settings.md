---
ms.assetid: 6086947f-f9ef-4e18-9f07-6c7c81d7002c
title: Strumenti e impostazioni del servizio Ora di Windows
description: ''
author: shortpatti
ms.author: pashort
manager: dougkim
ms.date: 10/16/2018
ms.topic: article
ms.prod: windows-server
ms.technology: networking
ms.openlocfilehash: 84d10c30d42e92d325475a1143c85acce7456a80
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 09/27/2019
ms.locfileid: "71395678"
---
# <a name="windows-time-service-tools-and-settings"></a>Strumenti e impostazioni del servizio Ora di Windows
>Si applica a: Windows Server 2016, Windows Server 2012 R2, Windows Server 2012, Windows 10 o versioni successive

In questo argomento vengono fornite informazioni sugli strumenti e le impostazioni per il servizio Ora di Windows (W32Time). 

Se vuoi solo sincronizzare l'ora per un computer client aggiunto al dominio, vedi [Configurare un computer client per la sincronizzazione automatica dell'ora del dominio](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/cc816884%28v%3dws.10%29). Per altri argomenti sulla configurazione del servizio ora di Windows, vedi [Dove trovare informazioni sulla configurazione del servizio Ora di Windows](https://docs.microsoft.com/windows-server/networking/windows-time-service/windows-time-service-top).  

> [!CAUTION]  
> Non usare il comando Net time per configurare o impostare l'ora mentre è in esecuzione il servizio Ora di Windows.  
>
> Inoltre, in computer meno recenti che eseguono Windows XP o versioni precedenti il comando Net time /querysntp visualizza il nome di un server NTP (Network Time Protocol) con cui un computer è configurato per la sincronizzazione, ma il server NTP viene usato solo quando il client di riferimento ora del computer è configurato come NTP o AllSync. Il comando è stato deprecato da allora.  

La maggior parte dei computer membri del dominio dispone di un tipo di client di riferimento ora NT5DS e pertanto sincronizza l'ora dalla gerarchia dei domini. L'unica eccezione tipica è il controller di dominio che funziona come master operazioni emulatore del controller di dominio primario (PDC) del dominio radice della foresta, che in genere è configurato per sincronizzare l'ora con un'origine ora esterna. Per visualizzare la configurazione del client di riferimento ora di un computer, esegui il comando W32tm /query /configuration da un prompt dei comandi con privilegi elevati a partire da Windows Server 2008 e Windows Vista e leggi la riga **Type** nell'output del comando. Per altre informazioni, vedi [Funzionamento del servizio Ora di Windows](https://docs.microsoft.com/windows-server/networking/windows-time-service/How-the-Windows-Time-Service-Works). Puoi eseguire il comando **reg query HKLM\SYSTEM\CurrentControlSet\Services\W32Time\Parameters** e leggere il valore di **NtpServer** nell'output del comando.  

> [!IMPORTANT]  
> Nelle versioni antecedenti a Windows Server 2016, il servizio W32Time non è progettato per soddisfare le esigenze delle applicazioni dipendenti dall'ora.  Tuttavia, gli aggiornamenti a Windows Server 2016 consentono ora di implementare una soluzione per l'accuratezza di 1 ms nel dominio.  Per altre informazioni, vedi [Ora esatta Windows 2016](accurate-time.md) e [Limiti di supporto per configurare il servizio Ora di Windows per gli ambienti con accuratezza elevata](https://docs.microsoft.com/windows-server/networking/windows-time-service/support-boundary).  

## <a name="windows-time-service-tools"></a>Strumenti del servizio Ora di Windows  
Gli strumenti seguenti sono associati al servizio Ora di Windows.  

#### <a name="w32tmexe-windows-time"></a>W32tm.exe: Ora di Windows  
**Categoria**  

Questo strumento viene installato come parte delle installazioni predefinite di Windows XP, Windows Vista, Windows 7, Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 e Windows Server 2008 R2.  

**Compatibilità delle versioni**  

Questo strumento è compatibile con le installazioni predefinite di Windows XP, Windows Vista, Windows 7, Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 e Windows Server 2008 R2.  

W32tm.exe viene usato per configurare le impostazioni del servizio Ora di Windows. Può anche essere usato per la diagnosi dei problemi del servizio Ora. W32tm.exe è lo strumento da riga di comando preferito per la configurazione, il monitoraggio o la risoluzione dei problemi del servizio Ora di Windows.  

Nelle tabelle seguenti vengono descritti i parametri usati con W32tm.exe.  

**Parametri primari di W32tm.exe**  


|                                                                                                                                  Parametro                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                                                                                                                   W32tm /?                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Guida della riga di comando di W32tm.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|                                                                                                                               W32tm /register                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Registra il servizio Ora per l'esecuzione come servizio e aggiunge la configurazione predefinita al Registro di sistema.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|                                                                                                                              W32tm /unregister                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Annulla la registrazione del servizio Ora e rimuove tutte le informazioni di configurazione dal Registro di sistema.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|                                                                                 w32tm /monitor<br /><br />[/domain:<domain name>] [/computers:<name>[,<name>[,<name>...]]] [/threads:<num>]                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                 domain: specifica il dominio da monitorare. Se non specifichi alcun nome di dominio o non indichi l'opzione domain o computers, viene usato il dominio predefinito. Questa opzione può essere usata più di una volta.<br /><br />computers: monitora l'elenco di computer specificato. I nomi dei computer sono separati da virgole, senza spazi. Se un nome è preceduto da '\*', viene considerato come PDC. Questa opzione può essere usata più di una volta.<br /><br />threads: specifica il numero di computer da analizzare simultaneamente. Il valore predefinito è 3. L'intervallo consentito è 1-50.                                                                                                                                                                                                                                                                                                                                                                                                                 |
|                                                                                                                         w32tm /ntte <NT time epoch>                                                                                                                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Converte un'ora di sistema NT, in intervalli (10 ^-7) da 0h 1-Jan 1601, in un formato leggibile.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|                                                                                                                        w32tm /ntpte <NTP time epoch>                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Converte un'ora NTP, in intervalli (2^-32) da 0h 1-Jan 1900, in un formato leggibile.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|                                                                               w32tm /resync<br /><br />[/computer:<computer>]<br /><br />[/nowait]<br /><br />[/rediscover]<br /><br />[/soft]                                                                               |                                                                                                                                                                                                                                                                                                                                                                      Indica a un computer che deve risincronizzare il clock il prima possibile, generando tutte le statistiche di errore accumulate.<br /><br />computer<computer>: specifica il computer che deve essere risincronizzato. Se non è specificato, viene risincronizzato il computer locale.<br /><br />nowait: indica di non attendere che si verifichi la risincronizzazione e di restituire immediatamente il controllo. In caso contrario, si attende il completamento della risincronizzazione prima della restituzione del controllo.<br /><br />rediscover: rileva di nuovo la configurazione di rete e individua di nuovo le origini di rete per poi eseguire la risincronizzazione.<br /><br />soft: esegue la risincronizzazione usando le statistiche degli errori esistenti. Non utile, fornito per la compatibilità.                                                                                                                                                                                                                                                                                                                                                                      |
|                                                          w32tm /stripchart<br /><br />/computer:<target><br /><br />[/period:<refresh>]<br /><br />[/dataonly]<br /><br />[/samples:<count>]<br/><br/>[/rdtsc]<br/>                                                          |                            Visualizza un grafico a strisce dell'offset tra il computer in uso e un altro computer.<br /><br />computer<target>: il computer rispetto al quale misurare l'offset.<br /><br />period<refresh>: specifica l'intervallo tra i campionamenti, espresso in secondi. Il valore predefinito è 2 s.<br /><br />dataonly: visualizza solo i dati senza grafica.<br /><br />samples<count>: raccoglie <count> campioni e quindi esegue l'arresto. Se non è specificato, i campioni verranno raccolti fino a quando non viene premuto **CTRL+C**.<br/><br/>rdtsc: per ogni campione, questa opzione consente di stampare i valori delimitati da virgole insieme alle intestazioni RdtscStart, RdtscEnd, FileTime, RoundtripDelay e NtpOffset anziché la grafica del testo.<br/><ul><li>[RdtscStart: valore RDTSC (Read TimeStamp Counter)](https://en.wikipedia.org/wiki/Time_Stamp_Counter) raccolto immediatamente prima della generazione della richiesta NTP.</li><li>RdtscEnd: valore RDTSC (Read TimeStamp Counter) raccolto immediatamente dopo la ricezione e l'elaborazione della risposta NTP.</li><li>FileTime: valore FILETIME locale usato nella richiesta NTP.</li><li>RoundtripDelay: tempo trascorso in secondi tra la generazione della richiesta NTP e l'elaborazione della risposta NTP ricevuta, calcolato in base ai calcoli del round trip NTP.</li><li>NTPOffset: offset dell'ora in secondi tra il computer locale e il server NTP, elaborato in base ai calcoli di offset NTP.</li></ul>                             |
| w32tm /config<br /><br />[/computer:<target>]<br /><br />[/update]<br /><br />[/manualpeerlist:<peers>]<br /><br />[/syncfromflags:<source>]<br /><br />[/LocalClockDispersion:<seconds>]<br /><br />[/reliable:(YES&#124;NO)]<br /><br />[/largephaseoffset:<milliseconds>] | computer<target>: regola la configurazione di <target>. Se non viene specificato, il valore predefinito è il computer locale.<br /><br />update: notifica al servizio Ora che la configurazione è stata modificata, rendendo attive le modifiche.<br /><br />manualpeerlist<peers>: imposta l'elenco dei peer manuali su <peers>, ovvero un elenco di indirizzi IP e/o DNS delimitati da spazi. Se vengono specificati più peer, questa opzione deve essere racchiusa tra virgolette.<br /><br />syncfromflags<source>: imposta le origini da cui il client NTP deve eseguire la sincronizzazione. <source> deve essere un elenco di queste parole chiave delimitate da virgole (senza distinzione tra maiuscole e minuscole):<br /><br />MANUAL: include i peer dall'elenco di peer manuali.<br /><br />DOMHIER: esegue la sincronizzazione da un controller di dominio nella gerarchia di domini.<br /><br />LocalClockDispersion<seconds>: configura l'accuratezza del clock interno che verrà stimato da W32Time quando non è in grado di acquisire l'ora dalle origini configurate.<br /><br />reliable:(YES&#124;NO): definisce se il computer è un'origine ora affidabile.<br /><br />Questa impostazione è significativa solo nei controller di dominio.<br /><br />YES: il computer è un servizio Ora affidabile.<br /><br />NO: il computer non è un servizio Ora affidabile.<br /><br />largephaseoffset<milliseconds>: imposta la differenza tra l'ora locale e l'ora della rete che verrà considerata da W32Time come un picco. |
|                                                                                                                                  w32tm /tz                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Visualizza le impostazioni del fuso orario corrente.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                                                                                                  w32tm /dumpreg<br /><br />[/subkey:<key>]<br /><br />[/computer:<target>]                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Visualizza i valori associati a una chiave del Registro di sistema specificata.<br /><br />La chiave predefinita è HKLM\System\CurrentControlSet\Services\W32Time<br /><br />(chiave radice per il servizio Ora).<br /><br />subkey<key>: visualizza i valori associati alla sottochiave <key> della chiave predefinita.<br /><br />computer<target>: esegue query sulle impostazioni del Registro di sistema per il computer <target>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|                                                                                  w32tm /query [/computer:<target>] {/source &#124; /configuration &#124; /peers &#124; /status} [/verbose]                                                                                   |                                                                                                                                                                                                                                                                                                                  Questo parametro è stato reso disponibile per la prima volta nelle versioni client del servizio Ora di Windows con Windows Vista e Windows Server 2008.<br /><br />Visualizza le informazioni del servizio Ora di Windows di un computer.<br /><br />**computer<target>** : esegue query sulle informazioni di **<target>** . Se non viene specificato, il valore predefinito è il computer locale.<br /><br />**Source**: visualizza l'origine ora.<br /><br />**Configuration**: visualizza la configurazione del runtime e l'origine dell'impostazione. In modalità dettagliata visualizza anche l'impostazione non definita o inutilizzata.<br /><br />**peers**: visualizza un elenco di peer e il relativo stato.<br /><br />**status**: visualizza lo stato del servizio Ora di Windows.<br /><br />**verbose**: imposta la modalità dettagliata per visualizzare altre informazioni.                                                                                                                                                                                                                                                                                                                   |
|                                                                                       w32tm /debug {/disable &#124; {/enable /file:<name> /size:<bytes> /entries:<value> [/truncate]}}                                                                                       |                                                                                                                                                                                                                                                                         Questo parametro è stato reso disponibile per la prima volta nelle versioni client del servizio Ora di Windows con Windows Vista e Windows Server 2008.<br /><br />Abilita o disabilita il log privato del servizio Ora di Windows del computer locale.<br /><br />**disable**: disabilita il log privato.<br /><br />**enable**: abilita il log privato.<br /><br />-   **file<name>** : specifica il nome file assoluto.<br />-   **size<bytes>** : specifica le dimensioni massime per la registrazione circolare.<br />-   **entries<value>** : contiene un elenco di flag, specificati in base al numero e separati da virgole, che specificano le informazioni che devono essere registrate. I numeri validi sono compresi tra 0 e 300. È accettato un intervallo di numeri, oltre a numeri singoli, ad esempio 0-100,103,106. Il valore 0-300 è per la registrazione di tutte le informazioni.<br /><br />**truncate**: tronca il file, se esistente.                                                                                                                                                                                                                                                                          |

---  
Per altre informazioni su **W32tm.exe**, vedi Guida e supporto tecnico in Windows XP, Windows Vista, Windows 7, Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 e Windows Server 2008 R2.  

## <a name="windows-time-service-registry-entries"></a>Voci del Registro di sistema del servizio Ora di Windows
Le voci del Registro di sistema seguenti sono associate al servizio Ora di Windows.  

Queste informazioni vengono fornite come riferimento utilizzabile durante la risoluzione dei problemi o per verificare che le impostazioni obbligatorie siano applicate. È consigliabile non modificare direttamente il Registro di sistema, a meno che non vi siano altre alternative. Modifiche al Registro di sistema non vengono convalidate dall'editor del Registro di sistema o da Windows prima di applicarle, e di conseguenza, possono essere archiviati i valori non corretti. Ciò può causare errori irreversibili nel sistema.  

Quando possibile, utilizzare criteri di gruppo o altri strumenti di Windows, ad esempio Microsoft Management Console (MMC) per eseguire attività, piuttosto che modificare direttamente il Registro di sistema. Se è necessario modificare il Registro di sistema, usare la massima cautela.  

> [!WARNING]  
> Alcuni dei valori preimpostati configurati nel file di modello di amministrazione di sistema (System.adm) per le impostazioni dell'oggetto Criteri di gruppo sono diversi rispetto alle voci del Registro di sistema predefinite corrispondenti. Se prevedi di usare un oggetto Criteri di gruppo per configurare un'impostazione del servizio Ora di Windows, è opportuno leggere l'articolo [I valori predefiniti per le impostazioni di Criteri di gruppo del servizio Ora di Windows sono diversi dalle corrispondenti voci del Registro di sistema del servizio Ora di Windows in Windows Server 2003](https://go.microsoft.com/fwlink/?LinkId=186066). Questo problema si applica a Windows Server 2008 R2, Windows Server 2008, Windows Server 2003 R2 e Windows Server 2003.  

Molte voci del Registro di sistema per il servizio Ora di Windows sono identiche a quelle dell'impostazione di Criteri di gruppo con lo stesso nome. Le impostazioni di Criteri di gruppo corrispondono alle voci del Registro di sistema con lo stesso nome che si trovano in:  

>**HKLM\SYSTEM\CurrentControlSet\Services\W32Time\\**


Sono presenti diverse chiavi del Registro di sistema in questo percorso. Le impostazioni del servizio Ora di Windows sono archiviate in valori in tutte le chiavi seguenti:

* [Parameters](#hklmsystemcurrentcontrolsetservicesw32timeparameters)
* [Config](#hklmsystemcurrentcontrolsetservicesw32timeconfig)
* [NtpClient](#hklmsystemcurrentcontrolsetservicesw32timetimeprovidersntpclient)
* [NtpServer](#hklmsystemcurrentcontrolsetservicesw32timetimeprovidersntpserver)

Molti dei valori nella sezione W32Time del Registro di sistema vengono usati internamente da W32Time per archiviare le informazioni. Questi valori non devono essere mai modificati manualmente. Non modificare alcuna impostazione di questa sezione, a meno che tu non abbia familiarità con l'impostazione e sia certo che il nuovo valore funzionerà come previsto. Le seguenti voci del Registro di sistema si trovano in:

**HKLM\SYSTEM\CurrentControlSet\Services\W32Time**  

Quando crei un criterio, le impostazioni vengono configurate nel percorso seguente, che non ha la precedenza sul percorso successivo:

**HKLM\SOFTWARE\Policies\Microsoft\Windows\W32time**

La chiave W32Time viene creata con il criterio.  Quando rimuovi il criterio, viene rimossa anche questa chiave.

L'altro percorso predefinito è:

**HKLM\SYSTEM\CurrentControlSet\Services\W32time**

Alcuni dei parametri vengono archiviati in tick del clock nel Registro di sistema e alcuni sono espressi in secondi. Per convertire l'ora da tick del clock in secondi:  

-   1 minuto = 60 sec  

-   1 sec = 1000 ms  

-   1 ms = 10.000 tick del clock in un sistema Windows, come descritto in [Proprietà DateTime.Ticks](https://docs.microsoft.com/dotnet/api/system.datetime.ticks?redirectedfrom=MSDN&view=netframework-4.7.2#System_DateTime_Ticks).  

Ad esempio, 5 minuti diventeranno 5\*60\*1000\*10000 = 3000000000 tick del clock. 

Tutte le versioni includono Windows 7, Windows 8, Windows 10, Windows Server 2008, Windows Server 2008 R2, Windows Server 2012, Windows Server 2012R2 e Windows Server 2016.  Alcune voci sono disponibili solo nelle versioni più recenti di Windows.

#### <a name="hklmsystemcurrentcontrolsetservicesw32timeparameters"></a>HKLM\SYSTEM\CurrentControlSet\Services\W32Time\Parameters

|          Voce del Registro di sistema          | Version |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|----------------------------------|---------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| AllowNonstandardModeCombinations |   Tutto   |                                                                                                                                                                                                                                                                                                                                                                                                              Voce che indica che sono consentite combinazioni di modalità non standard nella sincronizzazione tra peer. Il valore predefinito per i membri del dominio è 1. Il valore predefinito per i client e i server autonomi è 1.                                                                                                                                                                                                                                                                                                                                                                                                              |
|            NtpServer             |   Tutto   | Voce che specifica un elenco di peer delimitati da spazi da cui un computer ottiene i timestamp, costituiti da uno o più nomi DNS o indirizzi IP per riga. Ogni nome DNS o indirizzo IP elencato deve essere univoco. I computer connessi a un dominio devono eseguire la sincronizzazione con un'origine ora più affidabile, ad esempio l'orologio ufficiale degli Stati Uniti.  <ul><li>0x01 SpecialInterval </li><li>0x02 UseAsFallbackOnly</li><li>0x04 SymmetricActive: per altre informazioni su questa modalità, vedi [Windows Time Server: 3.3 Modes of Operation](https://go.microsoft.com/fwlink/?LinkId=208012) (Server di riferimento ora di Windows: modalità di funzionamento 3.3).</li><li>0x08 Client</li></ul><br />Non esiste alcun valore predefinito per questa voce del Registro di sistema nei membri del dominio. Il valore predefinito per i client e i server autonomi è time.windows.com,0x1.<br /><br />Nota: per altre informazioni sui server NTP disponibili, vedi l'[l'articolo 262680della Microsoft Knowledge Base - Elenco dei server di riferimento ora SNTP (Simple Network Time Protocol) disponibili su Internet](https://support.microsoft.com/help/262680/a-list-of-the-simple-network-time-protocol-sntp-time-servers-that-are) |
|            ServiceDll            |   Tutto   |                                                                                                                                                                                                                                                                                                                                                              Voce che viene gestita da W32Time. Contiene dati riservati usati dal sistema operativo Windows ed eventuali modifiche di questa impostazione possono generare risultati imprevedibili. Il percorso predefinito per questa DLL sia per i membri del dominio che per i client e i server autonomi è %windir%\System32\W32Time.dll.                                                                                                                                                                                                                                                                                                                                                               |
|           ServiceMain            |   Tutto   |                                                                                                                                                                                                                                                                                                                                                       Voce che viene gestita da W32Time. Contiene dati riservati usati dal sistema operativo Windows ed eventuali modifiche di questa impostazione possono generare risultati imprevedibili. Il valore predefinito per i membri del dominio è SvchostEntry_W32Time. Il valore predefinito per i client e i server autonomi è SvchostEntry_W32Time.  "                                                                                                                                                                                                                                                                                                                                                       |
|               Type               |   Tutto   |                                                                                                                                                                                                                                  Voce che indica i peer da cui accettare la sincronizzazione:  <ul><li>**NoSync**. Il servizio Ora non si sincronizza con altre origini.</li><li>**NTP.** Il servizio Ora si sincronizza a partire dai server specificati nella voce del Registro di sistema **NtpServer** .</li><li>**NT5DS**. Il servizio Ora si sincronizza a partire dalla gerarchia di domini.  </li><li>**AllSync**. Il servizio Ora usa tutti i meccanismi di sincronizzazione disponibili.  </li></ul>Il valore predefinito per i membri del dominio è **NT5DS**. Il valore predefinito per i client e i server autonomi è **NTP**.                                                                                                                                                                                                                                   |

---
#### <a name="hklmsystemcurrentcontrolsetservicesw32timeconfig"></a>HKLM\SYSTEM\CurrentControlSet\Services\W32Time\Config

|    Voce del Registro di sistema     |          Version           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|-----------------------|----------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|     AnnounceFlags     |            Tutto             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Voce che controlla se il computer è contrassegnato come server di riferimento ora affidabile. Un computer non è contrassegnato come affidabile a meno che non sia anche contrassegnato come server di riferimento ora.<br /> -   0x00 Not a time server  <br /> - 0x01 Always time server  <br /> -   0x02 Automatic time server  <br /> -   0x04 Always reliable time server  <br /> -   0x08 Automatic reliable time server  <br />Il valore predefinito per i membri del dominio è 10. Il valore predefinito per i client e i server autonomi è 10.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|     EventLogFlags     |            Tutto             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Voce che controlla gli eventi registrati dal servizio Ora.  <br />-   Time Jump: 0x1  <br />-   Source Change: 0x2  <br />Il valore predefinito per i membri del dominio è 2. Il valore predefinito per i client e i server autonomi è 2.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| FrequencyCorrectRate  |            Tutto             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Voce che controlla la frequenza con cui viene corretto il clock. Se questo valore è troppo basso, il clock è instabile e si corregge continuamente. Se questo valore è troppo alto, la sincronizzazione del clock richiede molto tempo. Il valore predefinito per i membri del dominio è 4. Il valore predefinito per i client e i server autonomi è 4.  <br /><br />Considera che 0 è un valore non valido per la voce del Registro di sistema FrequencyCorrectRate. Se nei computer Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 e Windows Server 2008 R2 il valore è impostato su 0, il servizio Ora di Windows lo cambierà automaticamente in 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|      HoldPeriod       |            Tutto             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Voce che controlla il periodo di tempo in cui è disabilitato il rilevamento dei picchi per sincronizzare rapidamente il clock locale. Un picco è un campione di ora che indica che l'ora non è sincronizzata per alcuni secondi e viene in genere ricevuto dopo la restituzione uniforme di campioni di ora validi. Il valore predefinito per i membri del dominio è 5. Il valore predefinito per i client e i server autonomi è 5.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|   LargePhaseOffset    |            Tutto             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Voce che specifica che un offset dell'ora maggiore o uguale a questo valore in 10<sup>-7</sup> secondi viene considerato un picco. Un'interruzione della rete, ad esempio una quantità elevata di traffico, può causare un picco. Un picco verrà ignorato a meno che non persista per un lungo periodo di tempo. Il valore predefinito per i membri del dominio è 50000000. Il valore predefinito per i client e i server autonomi è 50000000.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|     LastClockRate     |            Tutto             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Voce che viene gestita da W32Time. Contiene dati riservati usati dal sistema operativo Windows ed eventuali modifiche di questa impostazione possono generare risultati imprevedibili. Il valore predefinito per i membri del dominio è 156250. Il valore predefinito per i client e i server autonomi è 156250.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| LocalClockDispersion  |            Tutto             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Voce che controlla la dispersione (in secondi) che devi presupporre quando l'unica origine ora è il clock CMOS incorporato. Il valore predefinito per i membri del dominio è 10. Il valore predefinito per i client e i server autonomi è 10.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| MaxAllowedPhaseOffset |            Tutto             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Voce che specifica l'offset massimo (in secondi) per il quale W32Time tenta di regolare il clock del computer usando la frequenza di clock. Quando l'offset supera questa frequenza, W32Time imposta il clock del computer direttamente. Il valore predefinito per i membri del dominio è 300. Il valore predefinito per i client e i server autonomi è 1.  [Vedi più avanti per altre informazioni](#maxallowedphaseoffset-information).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|     MaxClockRate      |            Tutto             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Voce che viene gestita da W32Time. Contiene dati riservati usati dal sistema operativo Windows ed eventuali modifiche di questa impostazione possono generare risultati imprevedibili. Il valore predefinito per i membri del dominio è 155860. Il valore predefinito per i client e i server autonomi è 155860.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| MaxNegPhaseCorrection |            Tutto             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Voce che specifica la correzione dell'ora negativa massima in secondi eseguita dal servizio. Se il servizio determina che è necessaria una modifica di dimensioni maggiori, registra un evento. Caso speciale: 0xFFFFFFFF indica di eseguire sempre la correzione dell'ora. Il valore predefinito per i membri del dominio è 0xFFFFFFFF. Il valore predefinito per i client e i server autonomi è 54.000 (15 ore).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|    MaxPollInterval    |            Tutto             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Voce che specifica l'intervallo massimo in secondi log2 per l'intervallo di polling del sistema. Considera che mentre un sistema deve eseguire il polling in base all'intervallo pianificato, un provider può rifiutare di produrre campioni quando richiesto. Il valore predefinito per i controller di dominio è 10. Il valore predefinito per i membri del dominio è 15. Il valore predefinito per i client e i server autonomi è 15.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| MaxPosPhaseCorrection |            Tutto             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Voce che specifica la correzione dell'ora positiva massima in secondi eseguita dal servizio. Se il servizio determina che è necessaria una modifica di dimensioni maggiori, registra un evento. Caso speciale: 0xFFFFFFFF indica di eseguire sempre la correzione dell'ora. Il valore predefinito per i membri del dominio è 0xFFFFFFFF. Il valore predefinito per i client e i server autonomi è 54.000 (15 ore).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|     MinClockRate      |            Tutto             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Voce che viene gestita da W32Time. Contiene dati riservati usati dal sistema operativo Windows ed eventuali modifiche di questa impostazione possono generare risultati imprevedibili. Il valore predefinito per i membri del dominio è 155860. Il valore predefinito per i client e i server autonomi è 155860.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|    MinPollInterval    |            Tutto             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Voce che specifica l'intervallo minimo in secondi log2 per l'intervallo di polling del sistema. Considera che mentre un sistema non richiede campioni con una frequenza maggiore, un provider può produrre campioni in momenti diversi rispetto all'intervallo pianificato. Il valore predefinito per i controller di dominio è 6. Il valore predefinito per i membri del dominio è 10. Il valore predefinito per i client e i server autonomi è 10.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|   PhaseCorrectRate    |            Tutto             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Voce che controlla la frequenza con cui viene corretto l'errore della fase. Se specifichi un valore ridotto, l'errore di fase viene corretto rapidamente, ma il clock potrebbe diventare instabile. Se il valore è troppo alto, per correggere l'errore di fase è necessario più tempo. <br /><br />Il valore predefinito per i membri del dominio è 1. Il valore predefinito per i client e i server autonomi è 7.<br /><br />Nota: 0 è un valore non valido per la voce del Registro di sistema PhaseCorrectRate. Se nei computer Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 e Windows Server 2008 R2 il valore è impostato su 0, il servizio Ora di Windows lo cambia automaticamente in 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|   PollAdjustFactor    |            Tutto             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Voce che controlla la decisione di aumentare o ridurre l'intervallo di polling per il sistema. Maggiore è il valore, minore è l'entità dell'errore che causa la riduzione dell'intervallo di polling. Il valore predefinito per i membri del dominio è 5. Il valore predefinito per i client e i server autonomi è 5.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|   SpikeWatchPeriod    |            Tutto             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Voce che specifica per quanto tempo deve persistere un offset sospetto prima che venga accettato come corretto (in secondi). Il valore predefinito per i membri del dominio è 900. Il valore predefinito per i client e i server autonomi è 900.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|  TimeJumpAuditOffset  |            Tutto             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Numero intero senza segno che indica la soglia di controllo dei salti temporali, in secondi. Se il servizio Ora regola il clock locale impostando il clock direttamente e la correzione dell'ora è superiore a questo valore, il servizio registra un evento di controllo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|    UpdateInterval     |            Tutto             | La voce specifica il numero di tick del clock tra le regolazioni di correzione di fase. Il valore predefinito per i controller di dominio è 100. Il valore predefinito per i membri del dominio è 30.000. Il valore predefinito per i client e i server autonomi è 360.000.  <br /><br />**NOTA**: zero non è un valore valido per la voce del registro di Sistema UpdateInterval. Se nei computer con Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 e Windows Server 2008 R2 il valore è impostato su 0, il servizio Ora di Windows lo cambia automaticamente in 1.<br /><br />Le tre voci del Registro di sistema seguenti non fanno parte della configurazione predefinita di W32Time, ma possono essere aggiunte al Registro di sistema per ottenere funzionalità di registrazione avanzate. Le informazioni registrate nel registro eventi di sistema possono essere modificate cambiando il valore dell'impostazione EventLogFlags nell'Editor oggetti Criteri di gruppo. Per impostazione predefinita, il servizio Ora crea un log nel Visualizzatore eventi ogni volta che passa a una nuova origine ora.<br /><br />**AVVISO**: alcuni dei valori preimpostati configurati nel file di modello di amministrazione di sistema (System.adm) per le impostazioni dell'oggetto Criteri di gruppo sono diversi dalle voci del Registro di sistema predefinite corrispondenti. Se prevedi di usare un oggetto Criteri di gruppo per configurare un'impostazione del servizio Ora di Windows, è opportuno leggere l'articolo [I valori predefiniti per le impostazioni di Criteri di gruppo del servizio Ora di Windows sono diversi dalle corrispondenti voci del Registro di sistema del servizio Ora di Windows in Windows Server 2003](https://go.microsoft.com/fwlink/?LinkId=186066). Questo problema si applica a Windows Server 2008 R2, Windows Server 2008, Windows Server 2003 R2 e Windows Server 2003. |
|  UtilizeSslTimeData   | Versione successiva a Windows 10 build 1511 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             La voce 1 indica che W32Time userà più timestamp SSL per inizializzare un clock non accurato.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |

---
Per abilitare la registrazione W32Time, devono essere aggiunte le voci del Registro di sistema seguenti:  

|Voce del Registro di sistema|Version|Description|
|------------------------------------|---------------|----------------------------|
|FileLogEntries|Tutto|Voce che controlla la quantità di voci create nel file di log del servizio Ora di Windows. Il valore predefinito è None, che non registra alcuna attività del servizio Ora di Windows. I valori validi sono compresi tra 0 e 300. Questo valore non influisce sulle voci del registro eventi create normalmente dal servizio Ora di Windows.|
|FileLogName|Tutto|Voce che controlla il percorso e il nome file del registro del servizio Ora di Windows. Il valore predefinito è Blank e non deve essere modificato a meno che non sia stato modificato il valore di **FileLogEntries**. Un valore valido è un percorso completo e un nome file che verranno usati dal servizio Ora di Windows per creare il file di log. Questo valore non influisce sulle voci del registro eventi create normalmente dal servizio Ora di Windows.  |
|FileLogSize|Tutto|Voce che controlla il comportamento di registrazione circolare dei file di log del servizio Ora di Windows. Quando vengono definiti i valori per **FileLogEntries** e **FileLogName**, la voce definisce la dimensione, in byte, che può raggiungere il file di log prima che le voci di log meno recenti vengano sovrascritte con nuove voci. Usa 1000000 o un valore superiore per questa impostazione. Questo valore non influisce sulle voci del registro eventi create normalmente dal servizio Ora di Windows.  |

---

#### <a name="hklmsystemcurrentcontrolsetservicesw32timetimeprovidersntpclient"></a>HKLM\SYSTEM\CurrentControlSet\Services\W32Time\TimeProviders\NtpClient

|Voce del Registro di sistema|Version|Description|
|------------------------------------|---------------|----------------------------|
|AllowNonstandardModeCombinations|Tutto|Voce che indica che sono consentite combinazioni di modalità non standard nella sincronizzazione tra peer. Il valore predefinito per i membri del dominio è 1. Il valore predefinito per i client e i server autonomi è 1.|
|CompatibilityFlags|Tutto|Voce che specifica i valori e i flag di compatibilità seguenti: <br /><br />-   DispersionInvalid: 0x00000001  <br />-   IgnoreFutureRefTimeStamp: 0x00000002  <br /> -   AutodetectWin2K: 0x80000000  <br />-   AutodetectWin2KStage2: 0x40000000  <br /><br />Il valore predefinito per i membri del dominio è 0x80000000. Il valore predefinito per i client e i server autonomi è 0x80000000.  |
|CrossSiteSyncFlags|Tutto|Voce che determina se il servizio sceglie i partner di sincronizzazione all'esterno del dominio del computer. Le opzioni e i valori sono:  <br /><br />-   None: 0  <br />-   PdcOnly: 1  <br />-   All: 2  <br /><br />Questo valore viene ignorato se non è impostato il valore NT5DS. Il valore predefinito per i membri del dominio è 2. Il valore predefinito per i client e i server autonomi è 2.  |
|NomeDLL|Tutto|Voce che specifica il percorso della DLL per il provider servizi orari.  <br /><br />Il percorso predefinito per questa DLL sia per i membri del dominio che per i client e i server autonomi è %windir%\System32\W32Time.dll.|
|Abilitato|Tutto|Voce che indica se il provider NtpClient è abilitato nel servizio Ora corrente.  <br /><ul><li>Sì 1</li><li>No 0</li></ul>Il valore predefinito per i membri del dominio è 1. Il valore predefinito per i client e i server autonomi è 1.|
|EventLogFlags|Tutto|Voce che specifica gli eventi registrati dal servizio Ora di Windows.<ul><li>0x1: modifiche della raggiungibilità</li><li>0x2: asimmetria dei campioni estesa (applicabile solo a Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 e Windows Server 2008 R2)</li></ul>Il valore predefinito per i membri del dominio è 0x1. Il valore predefinito per i client e i server autonomi è 0x1.|
|InputProvider|Tutto|Voce che indica se abilitare NtpClient come InputProvider, che ottiene le informazioni sull'ora da NtpServer. NtpServer è un server di riferimento ora che risponde alle richieste dell'ora dei client sulla rete restituendo campioni di ora utili per la sincronizzazione del clock locale. <ul><li>Sì = 1  </li><li>No = 0 </li></ul><p>Valore predefinito sia per i membri del dominio che per i client autonomi: 1  |
|LargeSampleSkew|Tutto|Voce che specifica l'asimmetria massima dei campioni per la registrazione in secondi. Per garantire la conformità alle specifiche SEC (Securities and Exchange Commission), questo valore deve essere impostato su tre secondi. Gli eventi verranno registrati per questa impostazione solo se la voce EventLogFlags è configurata in modo esplicito per un'asimmetria estesa dei campioni 0x2. Il valore predefinito per i membri del dominio è 3. Il valore predefinito per i client e i server autonomi è 3.  |
|ResolvePeerBackOffMaxTimes|Tutto|Voce che specifica il numero massimo di volte in cui raddoppiare l'intervallo di attesa quando tentativi ripetuti di individuare un peer per la sincronizzazione hanno esito negativo. Un valore pari a zero indica che l'intervallo di attesa è sempre il minimo. Il valore predefinito per i membri del dominio è 7. Il valore predefinito per i client e i server autonomi è 7. |
|ResolvePeerBackoffMinutes|Tutto|Voce che specifica l'intervallo iniziale di attesa, in minuti, prima di tentare di individuare un peer con cui eseguire la sincronizzazione. Il valore predefinito per i membri del dominio è 15. Il valore predefinito per i client e i server autonomi è 15.  |
|SpecialPollInterval|Tutto|Voce che specifica l'intervallo di polling speciale in secondi per i peer manuali. Quando è abilitato il flag SpecialInterval 0x1, W32Time usa questo intervallo di polling anziché un intervallo di polling determinato dal sistema operativo. Il valore predefinito per i membri del dominio è 3.600. Il valore predefinito per i client e i server autonomi è 604.800.<br/><br/>La voce SpecialPollInterval è una novità della build 1702 ed è contenuta nei valori del Registro di sistema di configurazione MinPollInterval e MaxPollInterval.|
|SpecialPollTimeRemaining|Tutto|Voce che viene gestita da W32Time. Contiene dati riservati usati dal sistema operativo Windows. Specifica il tempo in secondi prima che W32Time esegua la risincronizzazione dopo il riavvio del computer. Eventuali modifiche apportate a questa impostazione possono provocare risultati imprevedibili. Il valore predefinito sia per i membri del dominio che per i client e i server autonomi viene lasciato vuoto.  |

---

#### <a name="hklmsystemcurrentcontrolsetservicesw32timetimeprovidersntpserver"></a>HKLM\SYSTEM\CurrentControlSet\Services\W32Time\TimeProviders\NtpServer

|Voce del Registro di sistema|Version|Description|
|------------------------------------|---------------|----------------------------|
|AllowNonstandardModeCombinations|Tutto|Voce che indica che sono consentite combinazioni di modalità non standard nella sincronizzazione tra client e server. Il valore predefinito per i membri del dominio è 1. Il valore predefinito per i client e i server autonomi è 1.|
|NomeDLL|Tutto|Voce che specifica il percorso della DLL per il provider servizi orari.<br /><br />Il percorso predefinito per questa DLL sia per i membri del dominio che per i client e i server autonomi è %windir%\System32\W32Time.dll.  |
|Abilitato|Tutto|Voce che indica se il provider NtpServer è abilitato nel servizio Ora corrente. <ul><li>Sì 1</li><li>No 0</li></ul>Il valore predefinito per i membri del dominio è 1. Il valore predefinito per i client e i server autonomi è 1.  |
|InputProvider|Tutto|Voce che indica se abilitare NtpClient come InputProvider, che ottiene le informazioni sull'ora da NtpServer. NtpServer è un server di riferimento ora che risponde alle richieste dell'ora dei client sulla rete restituendo campioni di ora utili per la sincronizzazione del clock locale. <ul><li>Sì = 1  </li><li>No = 0 </li></ul><p>Valore predefinito sia per i membri del dominio che per i client autonomi: 1  |

---

#### <a name="maxallowedphaseoffset-information"></a>Informazioni su MaxAllowedPhaseOffset
Per consentire a W32Time di impostare gradualmente il clock del computer, l'offset deve essere inferiore al valore di **MaxAllowedPhaseOffset** e soddisfare allo stesso tempo l'equazione seguente:  

* Windows Server 2016 R2 e versioni successive:
   ```  
    |CurrentTimeOffset| / (16*PhaseCorrectRate*pollIntervalInSeconds) <= SystemClockRate / 2  
   ``` 
* Windows Server 2012 R2 e versioni precedenti:
   ```  
   |CurrentTimeOffset| / (PhaseCorrectRate*UpdateInterval) <= SystemClockRate / 2  
   ``` 
Il valore **CurrentTimeOffset** viene misurato in tick del clock, dove 1 ms = 10.000 tick del clock in un sistema Windows.  

Anche la misurazione di **SystemClockRate** e **PhaseCorrectRate** viene eseguita in tick del clock. Per ottenere il valore **SystemClockRate**, puoi usare il comando seguente e convertirlo da secondi a tick del clock tramite la formula secondi*1000\*10000:  

```  
W32tm /query /status /verbose  
ClockRate: 0.0156000s  
```  

**SystemclockRate** è la frequenza del clock nel sistema. Usando 156000 secondi come esempio, il valore **SystemclockRate** sarebbe = 0,0156000 \* 1000 \* 10000 = 156000 tick del clock.  

Anche il valore di **MaxAllowedPhaseOffset** è espresso in secondi. Per convertirlo in tick del clock, moltiplica **MaxAllowedPhaseOffset**\*1000\*10000.  

Gli esempi seguenti illustrano come applicare questi calcoli con Windows Server 2012 R2 o una versione precedente.

**Esempio 1**: l'ora differisce di 4 minuti (ad esempio, la tua ora è 11.05 e il campione di ora ricevuto da un peer e che ritieni sia corretto è 11.09).
  
```
phasecorrectRate = 1  

UpdateInterval = 30000 (clock ticks)  

systemclockRate = 156000 (clock ticks)  

MaxAllowedPhaseOffset = 10min = 600 seconds = 600*1000\*10000=6000000000 clock ticks  

|currentTimeOffset| = 4mins = 4*60\*1000\*10000 = 2400000000 ticks  

Is CurrentTimeOffset <= MaxAllowedPhaseOffset?  

2400000000 <= 6000000000 = TRUE  
```

Soddisfa l'equazione precedente? 

```
(|CurrentTimeOffset| / (PhaseCorrectRate*UpdateInterval) <= SystemClockRate / 2)  

Is 2,400,000,000 / (30000*1) <= 156000/2  

Is 80,000 <= 78,000  

NO/FALSE  
```  

W32tm riporterà immediatamente indietro il clock.  

> [!NOTE]  
> In questo caso, se vuoi riportare lentamente il clock indietro, devi modificare anche i valori di **PhaseCorrectRate** o **updateInterval** nel Registro di sistema in modo che il risultato dell'equazione sia **TRUE**.  

**Esempio 2**: l'ora differisce di 3 minuti. 
 
```  
phasecorrectRate = 1  

UpdateInterval = 30000 (clock ticks)  

systemclockRate = 156000 (clock ticks)  

MaxAllowedPhaseOffset = 10min = 600 seconds = 600*1000\*10000=6000000000 clock ticks  

currentTimeOffset = 3mins = 3*60\*1000\*10000 = 1800000000 clock ticks  

Is CurrentTimeOffset <= MaxAllowedPhaseOffset?  

1800000000 <= 6000000000 = TRUE  
```  

Soddisfa l'equazione precedente?

```
(|CurrentTimeOffset| / (PhaseCorrectRate*UpdateInterval) <= SystemClockRate / 2)  

Is 3 mins (1,800,000,000) / (30000*1) <= 156000/2  

Is 60,000 <= 78,000  

YES/TRUE  
```  

In questo caso il clock verrà riportato indietro lentamente.  

## <a name="windows-time-service-group-policy-settings"></a>Impostazioni di Criteri di gruppo del servizio Ora di Windows  
Puoi configurare la maggior parte dei parametri W32Time tramite l'Editor oggetti Criteri di gruppo. Questa procedura include la configurazione di un computer come NTPServer o NTPClient, la configurazione del meccanismo di sincronizzazione dell'ora e la configurazione di un computer come origine ora affidabile.  

> [!NOTE]  
> Le impostazioni di Criteri di gruppo per il servizio Ora di Windows possono essere configurate nei controller di dominio Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 e Windows Server 2008 R2 e possono essere applicate solo a computer che eseguono Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 e Windows Server 2008 R2.  

Puoi trovare le impostazioni di Criteri di gruppo usate per configurare W32Time nello snap-in Editor oggetti Criteri di gruppo nei percorsi seguenti:  

-   Configurazione computer\Modelli amministrativi\Sistema\Servizio Ora di Windows  

    Configura **Impostazioni di configurazione globali** qui.  

-   Configurazione computer\Modelli amministrativi\Sistema\Servizio Ora di Windows\Provider servizi orari  

    Impostazioni **Configura client Windows NTP** qui.  

    **Abilita client Windows NTP** qui.  

    **Abilita server Windows NTP** qui.  

> [!WARNING]  
> Alcuni dei valori preimpostati configurati nel file di modello di amministrazione di sistema (System.adm) per le impostazioni dell'oggetto Criteri di gruppo sono diversi rispetto alle voci del Registro di sistema predefinite corrispondenti. Se prevedi di usare un oggetto Criteri di gruppo per configurare un'impostazione del servizio Ora di Windows, è opportuno leggere l'articolo [I valori predefiniti per le impostazioni di Criteri di gruppo del servizio Ora di Windows sono diversi dalle corrispondenti voci del Registro di sistema del servizio Ora di Windows in Windows Server 2003](https://go.microsoft.com/fwlink/?LinkId=186066). Questo problema si applica a Windows Server 2008 R2, Windows Server 2008, Windows Server 2003 R2 e Windows Server 2003.  

La tabella seguente elenca le impostazioni di Criteri di gruppo globali associate al servizio Ora di Windows e il valore preimpostato associato a ciascuna impostazione. Per altre informazioni su ogni impostazione, vedi le voci del Registro di sistema corrispondenti in [Voci del Registro di sistema del servizio Ora di Windows](#windows-time-service-registry-entries) più indietro in questo argomento. Le impostazioni seguenti sono contenute in un singolo oggetto Criteri di gruppo denominato **Impostazioni di configurazione globali**.  

**Impostazioni di Criteri di gruppo globali associate al servizio Ora di Windows**  

|Impostazione di Criteri di gruppo|Valore preimpostato|  
|------------------------|------------------|  
|AnnounceFlags|10|  
|EventLogFlags|2|  
|FrequencyCorrectRate|4|  
|HoldPeriod|5|  
|LargePhaseOffset|1280000|  
|LocalClockDispersion|10|  
|MaxAllowedPhaseOffset|300|  
|MaxNegPhaseCorrection|54.000 (15 ore)|  
|MaxPollInterval|15|  
|MaxPosPhaseCorrection|54.000 (15 ore)|  
|MinPollInterval|10|  
|PhaseCorrectRate|7|  
|PollAdjustFactor|5|  
|SpikeWatchPeriod|90|  
|UpdateInterval|100|  

La tabella seguente elenca le impostazioni disponibili per l'oggetto Criteri di gruppo **Configura client Windows NTP** e i valori preimpostati associati al servizio Ora di Windows. Per altre informazioni su ogni impostazione, vedi le voci del Registro di sistema corrispondenti in [Voci del Registro di sistema del servizio Ora di Windows](#windows-time-service-registry-entries) più indietro in questo argomento.  

**Impostazioni di Criteri di gruppo client NTP associate al servizio Ora di Windows**  

|Impostazione di Criteri di gruppo|Valore predefinito|  
|------------------------|-----------------|  
|NtpServer|time.windows.com,0x1|  
|Type|Opzioni predefinite:<br /><br />-   **NTP.** Da usare in computer non aggiunti a un dominio.<br />-   **NT5DS.** Da usare in computer aggiunti a un dominio.|  
|CrossSiteSyncFlags|2|  
|ResolvePeerBackoffMinutes|15|  
|ResolvePeerBackoffMaxTimes|7|  
|SpecialPollInterval|3600|  
|EventLogFlags|0|  

## <a name="network-ports-used-by-the-windows-time-service"></a>Porte di rete usate dal servizio Ora di Windows  
Il servizio Ora di Windows segue la specifica NTP, che richiede l'uso della porta UDP 123 per tutte le comunicazioni di sincronizzazione dell'ora. Questa porta è riservata dal servizio Ora di Windows e rimane riservata in qualsiasi momento. Ogni volta che il computer sincronizza il clock o fornisce l'ora a un altro computer, le comunicazioni avvengono sulla porta UDP 123.  

> [!NOTE]  
> Se disponi di un computer con più schede di rete (noto anche come computer multihomed), non puoi abilitare in modo selettivo il servizio Ora di Windows in base alla scheda di rete.  

## <a name="related-information"></a>Informazioni correlate  
Le risorse seguenti contengono informazioni aggiuntive pertinenti per questa sezione.  

-   RFC *1305* nel database IETF RFC  

